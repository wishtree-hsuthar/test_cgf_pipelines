"use strict";(self.webpackChunkpr74_cgf_hrdd_web_front=self.webpackChunkpr74_cgf_hrdd_web_front||[]).push([[1118],{51118:(e,l,i)=>{i.r(l),i.d(l,{default:()=>R});var s=i(97275),a=i(88970),t=i(85523),d=i(61419),r=i(697),n=i(35527),c=i(39281),o=i(79836),h=i(53382),m=i(35855),x=i(53994),u=i(94454),p=i(72791),b=i(61134),v=i(57689),j=i(11087),g=i(55294),f=i(14917),w=i(27659),N=(i(71605),i(12820)),Z=i(76218),k=i(1260),y=i(14227),E=i(28386),C=i(45736),S=i(80184);const R=()=>{(0,k.j)("Edit Role");const e=(0,v.UO)(),[l,i]=(0,p.useState)(!1),R=(0,v.s0)(),[M,T]=(0,N.Z)({titleMessage:"",descriptionMessage:"",messageType:""}),_=p.useRef();let A={};const[O,Y]=(0,p.useState)({...A}),[D,I]=(0,p.useState)(!1),{control:L,reset:F,setValue:U,handleSubmit:q}=(0,b.cI)({defaultValues:{roleName:"",status:"",description:""}}),B={description:{required:"Enter the description",maxLength:"Max char limit exceed",minLength:"minimum 3 characters required"}},P=e=>{var l;f.Y.info("Edit role - updateEditFields handler"),F({roleName:e.name,status:e.isActive?"active":"inactive",description:e.description}),l=e.privileges,f.Y.info("Edit role - createPrevileges handler"),Object.keys(l).forEach((e=>{console.log("tempPriv",e),A[e]={add:l[e].add,fill:l[e].fill,delete:l[e].delete,edit:l[e].edit,list:l[e].list,view:l[e].view,all:l[e].add&&l[e].delete&&l[e].edit&&l[e].view&&l[e].list&&("Assessment"!==l[e].moduleId.name||l[e].fill),name:l[e].moduleId.name}})),console.log("temp object",A),Y({...A})};return(0,p.useEffect)((()=>{let l=!0;const s=new AbortController;return l&&(async(l,s)=>{try{i(!0);const l=await g.Z.get(Z.Yn+"roles/".concat(e.id),{signal:s.signal});f.Y.info("Edit role - getRoleById handler"),console.log("edit get role by id",l),P(l.data),i(!1)}catch(d){var a,t;if(f.Y.info("Edit role - getRoleById handler catch error ".concat(null===d||void 0===d||null===(a=d.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)),"ERR_CANCELED"===(null===d||void 0===d?void 0:d.code))return;i(!1),(0,C.K)(d,T,_,R)}})(0,s),()=>{l=!1,s.abort()}}),[]),(0,S.jsxs)("div",{className:"page-wrapper",children:[(0,S.jsx)(w.Z,{myRef:_,titleMessage:M.titleMessage,descriptionMessage:M.descriptionMessage,messageType:M.messageType}),(0,S.jsx)("div",{className:"breadcrumb-wrapper",children:(0,S.jsx)("div",{className:"container",children:(0,S.jsxs)("ul",{className:"breadcrumb",children:[(0,S.jsx)("li",{children:(0,S.jsx)(j.rU,{to:"/roles",children:"Roles"})}),(0,S.jsx)("li",{children:(0,S.jsx)(j.rU,{to:"/roles/view-role/".concat(e.id),children:"View Role"})}),(0,S.jsx)("li",{children:"Edit Role"})]})})}),(0,S.jsx)("section",{children:(0,S.jsxs)("div",{className:"container",children:[(0,S.jsx)("div",{className:"form-header flex-between",children:(0,S.jsx)("h2",{className:"heading2",children:"Edit Role"})}),l?(0,S.jsx)(E.Z,{}):(0,S.jsx)("form",{onSubmit:q((async l=>{try{f.Y.info("Edit role - onSubmit1 handler");let s=JSON.parse(JSON.stringify(O));if(Object.keys(s).forEach((e=>{delete s[e].all,delete s[e].name})),!(e=>Object.values(e).some((e=>Object.values(e).some((e=>e)))))(s))return void T({titleMessage:"Hurray!",descriptionMessage:"Select atleast 1 privilege",messageType:"error"},(()=>_.current()));i(!0),I(!0);const a=await g.Z.put(Z.Yn+"roles/".concat(e.id),{description:l.description,isActive:"active"===l.status,privileges:s});200==a.status&&(i(!1),T({titleMessage:"Success!",descriptionMessage:a.data.message,messageType:"success"},(()=>_.current())),F({roleName:"",status:"active",description:""}),setTimeout((()=>R("/roles/view-role/".concat(e.id))),3e3))}catch(t){var s,a;f.Y.info("Edit role - onSubmit1 handler ".concat(null===t||void 0===t||null===(s=t.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)),I(!1),(0,C.K)(t,T,_,R)}})),children:(0,S.jsxs)("div",{className:"card-wrapper",children:[(0,S.jsxs)("div",{className:"card-blk flex-between",children:[(0,S.jsx)("div",{className:"card-form-field",children:(0,S.jsxs)("div",{className:"form-group",children:[(0,S.jsxs)("label",{htmlFor:"roleName",children:["Role Name ",(0,S.jsx)("span",{className:"mandatory",children:"*"})]}),(0,S.jsx)(b.Qr,{name:"roleName",control:L,render:e=>{let{field:l,fieldState:{error:i}}=e;return(0,S.jsx)(s.Z,{disabled:!0,...l,className:"input-field ".concat(i&&"input-error"),id:"outlined-basic",placeholder:"Enter role name",variant:"outlined",helperText:" "})}})]})}),(0,S.jsx)("div",{className:"card-form-field",children:(0,S.jsxs)("div",{className:"form-group",children:[(0,S.jsx)("label",{htmlFor:"status",children:"Status"}),(0,S.jsx)("div",{className:"radio-btn-field",children:(0,S.jsx)(b.Qr,{name:"status",control:L,render:e=>{let{field:l}=e;return(0,S.jsxs)(a.Z,{...l,"aria-labelledby":"demo-radio-buttons-group-label",name:"radio-buttons-group",className:"radio-btn",children:[(0,S.jsx)(t.Z,{value:"active",control:(0,S.jsx)(d.Z,{}),label:"Active"}),(0,S.jsx)(t.Z,{value:"inactive",control:(0,S.jsx)(d.Z,{}),label:"Inactive"})]})}})})]})}),(0,S.jsx)("div",{className:"card-form-field fullwidth",children:(0,S.jsxs)("div",{className:"form-group",children:[(0,S.jsxs)("label",{htmlFor:"description",children:["Description ",(0,S.jsx)("span",{className:"mandatory",children:"*"})]}),(0,S.jsx)(b.Qr,{name:"description",rules:{required:!0,maxLength:500,minLength:3},control:L,render:e=>{let{field:l,fieldState:{error:i}}=e;return(0,S.jsx)(s.Z,{multiline:!0,...l,onBlur:e=>U("description",e.target.value.trim()),inputProps:{maxLength:500},className:"input-textarea ".concat(i&&"input-textarea-error"),id:"outlined-basic",placeholder:"Enter description",helperText:i?B.description[i.type]:" ",variant:"outlined"})}})]})})]}),(0,S.jsx)(r.Z,{sx:{width:"100%"},className:"table-blk table-blk-role",children:(0,S.jsx)(n.Z,{sx:{width:"100%"},children:(0,S.jsx)(c.Z,{children:(0,S.jsxs)(o.Z,{sx:{minWidth:750},children:[(0,S.jsx)(y.Z,{}),(0,S.jsx)(h.Z,{children:Object.keys(O).map(((e,l)=>(0,S.jsxs)(m.Z,{hover:!0,children:[(0,S.jsx)(x.Z,{children:O[e].name}),(0,S.jsx)(x.Z,{align:"center",padding:"checkbox",children:"Assessment"===O[e].name&&(0,S.jsx)(u.Z,{className:"table-checkbox",checked:O[e].fill,onChange:()=>Y((l=>({...l,[e]:{...l[e],fill:!l[e].fill,list:l[e].list||!l[e].fill,view:l[e].view||!l[e].fill,all:!l[e].fill&&l[e].add&&l[e].edit&&l[e].delete}})))})}),(0,S.jsx)(x.Z,{align:"center",padding:"checkbox",children:"Dashboard"!==O[e].name&&(0,S.jsx)(u.Z,{className:"table-checkbox",checked:O[e].list,onChange:()=>Y((l=>({...l,[e]:{...l[e],list:!l[e].list,view:l[e].view&&!l[e].list||!1,edit:l[e].edit&&!l[e].list||!1,delete:l[e].delete&&!l[e].list||!1,add:l[e].add&&!l[e].list||!1,fill:l[e].fill&&!l[e].list||!1,all:!l[e].list&&l[e].add&&l[e].edit&&l[e].view&&l[e].delete}})))})}),(0,S.jsx)(x.Z,{align:"center",padding:"checkbox",children:"Dashboard"!==O[e].name&&(0,S.jsx)(u.Z,{className:"table-checkbox",checked:O[e].add,onChange:()=>Y((l=>({...l,[e]:{...l[e],add:!l[e].add,list:l[e].list||!l[e].add,view:l[e].view||!l[e].add,all:!l[e].add&&l[e].edit&&l[e].delete}})))})}),(0,S.jsx)(x.Z,{align:"center",padding:"checkbox",children:"Dashboard"!==O[e].name&&(0,S.jsx)(u.Z,{className:"table-checkbox",checked:O[e].edit,onChange:()=>Y((l=>({...l,[e]:{...l[e],edit:!l[e].edit,list:l[e].list||!l[e].edit,view:l[e].view||!l[e].edit,all:l[e].add&&!l[e].edit&&l[e].delete}})))})}),(0,S.jsx)(x.Z,{align:"center",padding:"checkbox",children:(0,S.jsx)(u.Z,{className:"table-checkbox",checked:O[e].view,onChange:()=>Y((l=>({...l,[e]:{...l[e],view:!l[e].view,list:l[e].list||!l[e].view,edit:l[e].edit&&!l[e].view||!1,delete:l[e].delete&&!l[e].view||!1,fill:l[e].fill&&!l[e].view||!1,all:l[e].add&&l[e].edit&&!l[e].view&&l[e].delete}})))})}),(0,S.jsx)(x.Z,{align:"center",padding:"checkbox",children:"Dashboard"!==O[e].name&&(0,S.jsx)(u.Z,{className:"table-checkbox",checked:O[e].delete,onChange:()=>Y((l=>({...l,[e]:{...l[e],delete:!l[e].delete,list:l[e].list||!l[e].delete,edit:l[e].edit||!l[e].delete,view:l[e].view||!l[e].delete,all:l[e].add&&!l[e].delete}})))})}),(0,S.jsx)(x.Z,{align:"center",padding:"checkbox",children:"Dashboard"!==O[e].name&&(0,S.jsx)(u.Z,{className:"table-checkbox",checked:O[e].all,onChange:()=>Y((l=>({...l,[e]:{...l[e],all:!l[e].all,list:!l[e].all,view:!l[e].all,add:!l[e].all,edit:!l[e].all,delete:!l[e].all,fill:"Assessment"===O[e].name&&!l[e].all}})))})})]},e)))})]})})})}),(0,S.jsxs)("div",{className:"form-btn flex-between add-members-btn",children:[(0,S.jsx)("button",{type:"reset",style:{marginTop:"20px"},className:"secondary-button mr-10",onClick:()=>{R("/roles/view-role/".concat(e.id))},children:"Cancel"}),(0,S.jsx)("button",{type:"submit",className:"primary-button",style:{marginTop:"20px"},disabled:D,children:"Update"})]})]})})]})})]})}}}]);
//# sourceMappingURL=1118.7a7218e0.chunk.js.map