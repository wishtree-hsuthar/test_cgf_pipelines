"use strict";(self.webpackChunkpr74_cgf_hrdd_web_front=self.webpackChunkpr74_cgf_hrdd_web_front||[]).push([[2700],{62700:(e,l,n)=>{n.r(l),n.d(l,{AlphaNumRegEx:()=>A,AlphaRegEx:()=>N,NumericRegEx:()=>M,default:()=>S});var t=n(29823),o=n(40600),i=n(27954),s=n(12104),a=n(94294),d=n(68096),r=n(47071),c=n(20068),u=n(97275),v=n(58406),p=n(63903),m=n(36571),h=n(51514),x=n(7792),g=n(72791),f=n(57689),j=n(94677),y=n(76218),w=n(40385),C=n(71300),b=(n(27181),n(14917)),k=(n(12820),n(80184));const N=/^[a-zA-Z ]*$/,M=/^[0-9]+$/i,A=/^[a-z0-9]+$/i,T=[".jpg",".jpeg",".png",".doc",".txt",".pdf",".docx",".xlsx",".xls",".ppt",".pptx",".mp4",".mp3",".zip",".rar"],S=e=>{var l,n,t,S,D,E,F,_;let{isPrefilled:B,assessmentQuestionnaire:I,cell:O,columnId:R,sectionUUID:z,rowId:L,setAssessmentQuestionnaire:P,answer:H,transformedColumns:U,error:W,editMode:$,handleAnswersChange:K,handleAnswersBlur:Q,myRef:G,setToasterDetails:V}=e;const[Y,q]=(0,g.useState)(!1),[J,X]=(0,g.useState)(!1),ee=(0,f.s0)(),le=(0,f.UO)(),[ne,te]=(0,g.useState)(!1),[oe,ie]=(0,g.useState)(!1),[se,ae]=(0,g.useState)([]),[de,re]=(0,g.useState)(!1),[ce,ue]=(0,g.useState)(!1),ve=e=>{e.preventDefault()},[pe,me]=(0,g.useState)(!1),he=(0,g.useRef)(null),[xe,ge]=(0,g.useState)([]);let fe=B||!B&&I&&!Object.keys(I).length>0?null===O||void 0===O?void 0:O.columnId:R;const je=()=>{ge([]),ie(!1),te(!1)};return(0,g.useEffect)((()=>{var e;if(H&&(null===H||void 0===H?void 0:H.length)>0&&Array.isArray(H)&&0===(null===xe||void 0===xe?void 0:xe.length)&&!oe&&ae([...H]),"attachments"===(null===(e=U[fe])||void 0===e?void 0:e.columnType)&&"string"===typeof H){let e={...I};e[z]["".concat(fe,"_").concat(L)]=[],P(e)}}),[]),(0,g.useEffect)((()=>{H&&(null===H||void 0===H?void 0:H.length)>0&&Array.isArray(H)&&0===(null===xe||void 0===xe?void 0:xe.length)&&!oe&&ge([...H])}),[xe]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(C.Z,{title:(0,k.jsx)("p",{children:"Add Attachments"}),info1:" ",info2:pe?(0,k.jsx)("div",{className:"loader-blk",children:(0,k.jsx)("img",{src:w.Z,alt:"Loading"})}):(0,k.jsxs)("div",{className:"upload-file-wrap",children:[(0,k.jsx)(a.Z,{variant:"contained",component:"label",className:"upload-file-btn",children:(0,k.jsxs)("div",{className:(null===xe||void 0===xe?void 0:xe.length)>0?"upload-file-blk selected-file-blk":"upload-file-blk",children:[(0,k.jsx)("input",{ref:he,type:"file",hidden:!0,accept:".jpg, .jpeg, .png, .doc, .txt, .pdf, .docx, .xlsx, .xls, .ppt, .pptx, .mp4, .mp3, .zip, .rar",name:"files[]",onChange:async e=>{var l,n;let t=await(null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.files);(null===(n=Object.keys(t))||void 0===n?void 0:n.length)>100?V({titleMessage:"",descriptionMessage:"Max file count 100 reached",messageType:"error"},(()=>G.current())):((async e=>{let l=[...xe],n=0;me(!0);for(const t of e)try{const e=10485760;if((null===t||void 0===t?void 0:t.size)>e){n+=1;continue}const o=null===t||void 0===t?void 0:t.name.split("."),i="."+o[(null===o||void 0===o?void 0:o.length)-1];if(!T.includes(i)){n+=1;continue}l.push(t)}catch(W){me(!1)}ge(l),n&&ue(!0),me(!1)})(t),he.current&&(he.current.value=""))},multiple:!0}),(0,k.jsx)("span",{className:"upload-icon",children:(0,k.jsx)(o.Z,{})}),(0,k.jsxs)("span",{className:"file-upload-txt",children:["Click here to choose files (max file size"," ","".concat("10"," MB"),")"]})]})}),(0,k.jsx)("p",{style:{color:"#f7a823",fontFamily:"ProximaNova-Semibold, serif, sans-serif",margin:"10px 0px"},children:"Uploading large files may take some time"}),(null===xe||void 0===xe?void 0:xe.length)>0&&(0,k.jsx)(Z,{currentSelectedFiles:xe,setCurrentSelectedFiles:ge,setIsFileRemoved:ie})]}),primaryButtonText:"Save",secondaryButtonText:"Cancel",onPrimaryModalButtonClickHandler:async()=>{b.Y.info("TableLAyoutCellComponent - uploadAttachmentButtonClickHandlerhandler "),re(!0);try{const e=(e=>{const l=new FormData;for(const n of e)l.append("files[]",n);return l.append("dummy","dummy Content"),l})(xe.filter((e=>!(null!==e&&void 0!==e&&e.location)))),l=xe.filter((e=>null===e||void 0===e?void 0:e.location));let n=y.A+"/".concat(null===le||void 0===le?void 0:le.id,"/attachments/").concat(z,"/").concat(fe+"_"+L);const t=await j.H.post(n,e,{headers:{"Content-Type":"multipart/form-data"}});await j.H.put(n,{attachments:[...l,...null===t||void 0===t?void 0:t.data]}),re(!1);let o={...I};o[z]["".concat(fe,"_").concat(L)]=[...l,...null===t||void 0===t?void 0:t.data],V({titleMessage:"",descriptionMessage:"Attachments saved!",messageType:"success"},(()=>G.current())),P(o),ge([]),te(!1),ie(!1)}catch(W){var e,l,n,t;if(console.log("error while adding attachment",W),re(!1),"ERR_CANCELED"===(null===W||void 0===W?void 0:W.code))return;if(400===(null===W||void 0===W||null===(e=W.response)||void 0===e?void 0:e.status)&&"Invalid assessment id!"===(null===W||void 0===W||null===(l=W.response)||void 0===l||null===(n=l.data)||void 0===n?void 0:n.message))V({titleMessage:"Oops!",descriptionMessage:"Oops!! There is some error while saving assessment details. Either someone has removed this assessment or looks like invalid assessment getting submitted. For more details please contact system / CGF admin",messageType:"error"},(()=>G.current())),setTimeout((()=>{ee("/assessment-list")}),3e3);else if(401===(null===W||void 0===W||null===(t=W.response)||void 0===t?void 0:t.status))V({titleMessage:"Oops!",descriptionMessage:"Session Timeout: Please login again",messageType:"error"},(()=>G.current())),setTimeout((()=>{ee("/login")}),3e3);else{var o,i;V({titleMessage:"Error",descriptionMessage:null!==W&&void 0!==W&&null!==(o=W.response)&&void 0!==o&&null!==(i=o.data)&&void 0!==i&&i.message&&"string"===typeof W.response.data.message?W.response.data.message:"Oops! Something went wrong. Please try again later.!",messageType:"error"},(()=>G.current()))}}},isDisabledPrimaryButton:de,onSecondaryModalButtonClickHandler:je,openModal:ne,setOpenModal:te,isModalForm:!0,handleCloseRedirect:je}),(0,k.jsx)(C.Z,{title:(0,k.jsx)("p",{children:"Alert"}),info1:" ",info2:(0,k.jsxs)("p",{className:"mb-30",style:{padding:"20px",textAlign:"left"},children:["Unable to attach the file due to one of the following reasons:",(0,k.jsxs)("ul",{style:{padding:"20px"},children:[(0,k.jsx)("li",{children:"File size exceeding more than 10 MB"}),(0,k.jsx)("li",{children:"Allowed file types - jpg, jpeg, png, doc, txt, pdf, docx, xlsx, xls, ppt, pptx, mp4, mp3, zip, rar"})]})]}),openModal:ce,setOpenModal:ue,isModalForm:!0,primaryButtonText:"OK",hideCloseIcon:!0,onPrimaryModalButtonClickHandler:()=>ue(!1)}),B&&U[fe]&&"prefilled"===U[fe].columnType&&(0,k.jsx)("p",{className:"text-justify",children:Y?(0,k.jsxs)("span",{children:[(0,k.jsx)("span",{children:null===O||void 0===O?void 0:O.value}),(0,k.jsx)("br",{}),(0,k.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),q(!1)},className:"show-more-less-txt",children:"Show Less"})]}):(0,k.jsx)("span",{children:(null===O||void 0===O?void 0:O.value.length)>100?(0,k.jsxs)("span",{children:[(0,k.jsxs)("span",{children:[null===O||void 0===O?void 0:O.value.slice(0,100),"..."]}),(0,k.jsx)("br",{}),(0,k.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),q(!0)},className:"show-more-less-txt",children:"Show More"})]}):null===O||void 0===O?void 0:O.value})}),U[fe]&&"attachments"===(null===(l=U[fe])||void 0===l?void 0:l.columnType)&&(0,k.jsxs)(d.Z,{children:[(0,k.jsx)("a",{href:"#",onClick:()=>te(!0),style:{color:"#f7a823",textDecoration:"none",pointerEvents:"".concat(($&&le["*"].includes("view")||!$)&&"none")},children:"Add/Edit Attachments"}),(0,k.jsx)(r.Z,{children:H&&0!==(null===H||void 0===H?void 0:H.length)||!W||0===(null===W||void 0===W?void 0:W.length)?"":W})]}),(0,k.jsx)("span",{className:"list-uploaded-file",children:U[fe]&&"attachments"===(null===(n=U[fe])||void 0===n?void 0:n.columnType)&&H&&(null===H||void 0===H?void 0:H.length)>0&&Array.isArray(H)&&(0,k.jsxs)(k.Fragment,{children:[H.map(((e,l)=>{var n,t,o,i;return(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.length)<=30?(l<=1||J)&&(0,k.jsx)("a",{href:null!==(t=y.Wy+le.id+"/attachments?id="+(null===e||void 0===e?void 0:e.location))&&void 0!==t?t:"#",style:{textDecoration:"none",display:"table",color:"".concat(null!==(o=e.location)&&void 0!==o?o:"#1e1e1e"),pointerEvents:"".concat(!e.location&&"none")},children:(0,k.jsx)(k.Fragment,{children:"".concat(null===e||void 0===e?void 0:e.name)})},l):(l<=1||J)&&(0,k.jsx)(c.Z,{title:null===e||void 0===e?void 0:e.name,style:{textDecoration:"none"},placement:"bottom-start",children:(0,k.jsx)("a",{href:e.location?y.Wy+le.id+"/attachments?id="+(null===e||void 0===e?void 0:e.location):"#",style:{display:"table",textDecoration:"none",color:"".concat(!e.location&&"#1e1e1e"),cursor:"".concat(e.location?"pointer":"default")},children:"".concat(null===e||void 0===e||null===(i=e.name)||void 0===i?void 0:i.slice(0,30),"...")})},l)})),J?(0,k.jsx)("a",{href:"#",onClick:e=>{X(!1)},className:"show-more-less-txt",style:{marginTop:"5px",display:"inline-block"},children:(null===H||void 0===H?void 0:H.length)>2&&"Show Less"}):(0,k.jsx)("a",{href:"#",onClick:e=>{X(!0)},className:"show-more-less-txt",style:{marginTop:"5px",display:"inline-block"},children:(null===H||void 0===H?void 0:H.length)>2&&"Show More"})]})}),U[fe]&&"textbox"===U[fe].columnType&&(0,k.jsx)(u.Z,{className:"input-field ".concat(!H&&W&&0!==(null===W||void 0===W?void 0:W.length)||H&&W&&"alphabets"===(null===(t=U[fe])||void 0===t?void 0:t.validation)&&!N.test(H)||H&&W&&"alphanumeric"===(null===(S=U[fe])||void 0===S?void 0:S.validation)&&!A.test(H)||H&&W&&"numeric"===(null===(D=U[fe])||void 0===D?void 0:D.validation)&&!M.test(H)?"input-error":""),disabled:$&&le["*"].includes("view")||!$,placeholder:"Enter text here",value:H,name:"".concat(fe,"_").concat(L),onChange:e=>K(e.target.name,e.target.value),onBlur:e=>Q(e.target.name,e.target.value),helperText:!H&&W&&0!==(null===W||void 0===W?void 0:W.length)||H&&"alphabets"===(null===(E=U[fe])||void 0===E?void 0:E.validation)&&!N.test(H)||H&&"numeric"===(null===(F=U[fe])||void 0===F?void 0:F.validation)&&!M.test(H)||H&&"alphanumeric"===(null===(_=U[fe])||void 0===_?void 0:_.validation)&&!A.test(H)?W:" "}),U[fe]&&"dropdown"===U[fe].columnType&&(0,k.jsx)("div",{className:"select-field",children:(0,k.jsxs)(d.Z,{className:"fullwidth-field",children:[(0,k.jsx)(v.Z,{IconComponent:e=>(0,k.jsx)(s.Z,{...e}),name:"".concat(fe,"_").concat(L),displayEmpty:!0,disabled:$&&le["*"].includes("view")||!$,value:H,className:"".concat(!H&&W&&0!==(null===W||void 0===W?void 0:W.length)?"select-field-error":""),onChange:e=>{K(e.target.name,e.target.value)},renderValue:e=>{const l=U[fe].options.find((l=>l.toLowerCase()===e.toLowerCase()));return l||(0,k.jsx)("div",{className:"select-placeholder",children:"Choose dropdown value"})},children:U[fe].options.map((e=>(0,k.jsx)(p.Z,{value:e,children:(null===e||void 0===e?void 0:e.length)<=40?e:(0,k.jsx)(c.Z,{title:e,children:(0,k.jsx)("span",{children:(null===e||void 0===e?void 0:e.slice(0,40))+"..."})})},e)))}),(0,k.jsx)(r.Z,{children:!H&&W&&0!==(null===W||void 0===W?void 0:W.length)?W:" "})]})}),U[fe]&&"date"===U[fe].columnType&&(0,k.jsx)(d.Z,{fullWidth:!0,children:(0,k.jsxs)(m._,{dateAdapter:x.y,children:[(0,k.jsx)(h.M,{disabled:$&&le["*"].includes("view")||!$,value:H,className:"datepicker-blk",components:{OpenPickerIcon:i.Z},onChange:e=>{K("".concat(fe,"_").concat(L),new Date(new Date(e)).toLocaleDateString("en"))},renderInput:e=>(0,k.jsx)(u.Z,{...e,autoComplete:"off",onKeyDown:ve,className:"input-field".concat(!H&&W&&0!==(null===W||void 0===W?void 0:W.length)&&"input-error")})}),(0,k.jsx)(r.Z,{children:!H&&W&&0!==(null===W||void 0===W?void 0:W.length)?W:" "})]})})]})},Z=e=>{let{currentSelectedFiles:l,setCurrentSelectedFiles:n,setIsFileRemoved:o}=e;const i=e=>{let t=[...l];t.splice(e,1),n(t),o(!0)};return(0,k.jsx)(k.Fragment,{children:l.map(((e,l)=>{var n,o,s,a;return(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.length)<=40?(0,k.jsxs)("p",{className:"select-filename",children:[(0,k.jsx)("a",{href:null!==(o=null===e||void 0===e?void 0:e.location)&&void 0!==o?o:"#",style:{textDecoration:"none",color:"".concat(!(null!==e&&void 0!==e&&e.location)&&"#1e1e1e"),pointerEvents:"".concat(!(null!==e&&void 0!==e&&e.location)&&"none")},children:null===e||void 0===e?void 0:e.name}),(0,k.jsxs)("span",{className:"file-close-icon",style:{cursor:"pointer"},onClick:()=>i(l),children:[" ",(0,k.jsx)(t.Z,{})]})]},l):(0,k.jsx)(c.Z,{title:null===e||void 0===e?void 0:e.name,children:(0,k.jsxs)("p",{className:"select-filename",children:[(0,k.jsx)("a",{href:null!==(s=null===e||void 0===e?void 0:e.location)&&void 0!==s?s:"#",style:{textDecoration:"none",color:"".concat(!(null!==e&&void 0!==e&&e.location)&&"#1e1e1e"),pointerEvents:"".concat(!(null!==e&&void 0!==e&&e.location)&&"none")},children:(null===e||void 0===e||null===(a=e.name)||void 0===a?void 0:a.slice(0,30))+"..."}),(0,k.jsxs)("span",{className:"file-close-icon",style:{cursor:"pointer"},onClick:()=>i(l),children:[" ",(0,k.jsx)(t.Z,{})]})]})},l)}))})}}}]);
//# sourceMappingURL=2700.78f687b4.chunk.js.map