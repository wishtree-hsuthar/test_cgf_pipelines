"use strict";(self.webpackChunkpr74_cgf_hrdd_web_front=self.webpackChunkpr74_cgf_hrdd_web_front||[]).push([[8177],{8617:function(e,n,t){t.r(n),t.d(n,{default:function(){return V}});var i=t(4165),s=t(1413),r=t(5861),o=t(885),a=t(2791),l=t(6015),u=t(4293),c=t(5814),d=t(166),v=t(8588),p=t(1346),h=t(9407),f=t(7265),m=t(2900),x=t(6321),g=t(5473),b=t(8723),j=t(4917),w=t(7792),y=t(6571),Z=t(2104),N=t(7954),q=t(184),k={PaperProps:{style:{maxHeight:168}},anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"}},T=function(e){var n=e.question,t=n.questionTitle;console.log("question: ",n),j.Y.debug("title preview question",t),j.Y.debug("title preview question",n.questionTitle);var i="singleTextbox"===n.inputType?(0,q.jsx)(v.Z,{placeholder:"Enter text here",className:"input-field",InputProps:{readOnly:!0}}):"textarea"===n.inputType?(0,q.jsx)(v.Z,{multiline:!0,InputProps:{readOnly:!0},className:"input-textarea",placeholder:"Enter text here",variant:"outlined"}):"dropdown"===n.inputType?(0,q.jsx)("div",{className:"form-group",children:(0,q.jsx)("div",{className:"select-field",children:(0,q.jsx)(p.Z,{IconComponent:function(e){return(0,q.jsx)(Z.Z,(0,s.Z)({},e))},value:n.questionTitle,MenuProps:k,renderValue:function(){return(0,q.jsx)("div",{className:"select-placeholder",children:"Choose dropdown value"})},children:n.options.map((function(e){return(0,q.jsx)(h.Z,{value:e,disabled:!0,children:e},e)}))})})}):"radioGroup"===n.inputType?(0,q.jsx)("div",{className:"radio-btn-field radio-btn-half-blk",children:(0,q.jsx)(f.Z,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"Active",name:"radio-buttons-group",className:"radio-btn radio-btn-vertical",children:n.options.map((function(e){return(0,q.jsx)(m.Z,{value:e,control:(0,q.jsx)(x.Z,{disabled:!0}),label:e},e)}))})}):"checkbox"===n.inputType?(0,q.jsx)("div",{className:"checkbox-with-labelblk checkbox-btn-half-blk",children:n.options.map((function(e){return(0,q.jsx)(m.Z,{className:"checkbox-with-label checkbox-flex",control:(0,q.jsx)(g.Z,{disabled:!0}),label:e},e)}))}):"date"===n.inputType?(0,q.jsx)(y._,{dateAdapter:w.y,children:(0,q.jsx)(b.M,{disabled:!0,value:null,className:"datepicker-blk",components:{OpenPickerIcon:N.Z},onChange:function(){},renderInput:function(e){return(0,q.jsx)(v.Z,(0,s.Z)((0,s.Z)({},e),{},{helperText:" "}))}})}):"";return(0,q.jsx)("div",{className:"preview-que-blk",children:(0,q.jsxs)("div",{className:"form-group",children:[(0,q.jsx)("label",{htmlFor:"questionTitle",children:(0,q.jsxs)("div",{className:"preview-sect-txt",children:[t,(null===n||void 0===n?void 0:n.isRequired)&&(0,q.jsx)("span",{className:"mandatory",children:" *"})]})}),(0,q.jsx)("div",{className:"que-half-sect",children:i})]})})},M=t(3989);var D=function(e){var n=e.questionnaire,t=e.section,i=e.sectionIndex;return(0,a.useEffect)((function(){j.Y.debug("section:- ",t)}),[]),(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)("div",{className:"preview-sect-ttl-wrap",children:[(0,q.jsx)("div",{className:"preview-sect-card-ttl-blk",children:(0,q.jsx)("h2",{className:"subheading",children:null===t||void 0===t?void 0:t.sectionTitle})}),(0,q.jsx)("div",{className:"preview-sect-txt",children:null===t||void 0===t?void 0:t.description})]}),(0,q.jsx)("div",{className:"preview-card-wrapper",children:(0,q.jsx)("div",{className:"preview-que-wrap que-preview",children:"form"===(null===t||void 0===t?void 0:t.layout)?t.questions.map((function(e){return(0,q.jsx)(T,{question:e},null===e||void 0===e?void 0:e.uuid)})):(0,q.jsx)(M.Z,{questionnaire:n,sectionIndex:i,isPreview:!0})})})]})},P=t(7689),C=t(1087),S=t(4677),E=t(6218),I=t(1260),O=t(9434),Q=t(2898),Y=t(2820),A=t(7659),_=t(8460),H=t(1300),R=t(4569),B=t.n(R),z=t(7806),U=t(8386);function L(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var V=function(e){var n,t,v,p,h,f,m,x,g,b=(0,a.useState)(0),w=(0,o.Z)(b,2),y=w[0],Z=w[1];(0,I.j)("Preview Questionnaire");var N=(0,a.useState)(!1),k=(0,o.Z)(N,2),T=k[0],M=k[1],R=(0,a.useState)(!1),V=(0,o.Z)(R,2),F=V[0],W=V[1],K=(0,Y.Z)({titleMessage:"",descriptionMessage:"",messageType:"success"}),G=(0,o.Z)(K,2),J=G[0],X=G[1],$=(0,a.useRef)(),ee=(0,P.UO)(),ne=(0,P.s0)();j.Y.debug("params in questionnaire",ee["*"].includes("version")),j.Y.debug("props in questionnaire",e);var te=(0,a.useState)({}),ie=(0,o.Z)(te,2),se=ie[0],re=ie[1],oe=(0,O.v9)((function(e){var n;return null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.privilege})),ae=(0,O.v9)((function(e){var n;return null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.userObj})),le="Super Admin"===(null===oe||void 0===oe?void 0:oe.name),ue=("Super Admin"===(null===ae||void 0===ae||null===(n=ae.roleId)||void 0===n?void 0:n.name)?[]:Object.values(null===oe||void 0===oe?void 0:oe.privileges)).filter((function(e){var n;return"Questionnaire"===(null===e||void 0===e||null===(n=e.moduleId)||void 0===n?void 0:n.name)})).map((function(e){return{questionnaire:{list:null===e||void 0===e?void 0:e.list,view:null===e||void 0===e?void 0:e.view,edit:null===e||void 0===e?void 0:e.edit,delete:null===e||void 0===e?void 0:e.delete,add:null===e||void 0===e?void 0:e.add}}}));(0,a.useEffect)((function(){var e=!0,n=new AbortController,t=function(){var t=(0,r.Z)((0,i.Z)().mark((function t(){var r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,M(!0),t.next=4,S.H.get("".concat(E.ZW,"/").concat(ee.id),{signal:n.signal});case 4:r=t.sent,j.Y.debug("response from fetch questionnaire",r),e&&re((0,s.Z)({},r.data)),M(!1),t.next=17;break;case 10:if(t.prev=10,t.t0=t.catch(0),"ERR_CANCELED"!==(null===t.t0||void 0===t.t0?void 0:t.t0.code)){t.next=14;break}return t.abrupt("return");case 14:M(!1),he(t.t0),j.Y.debug("error from fetch questionnaire",t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!1,n.abort()}}),[]);var ce=(0,a.useState)(!1),de=(0,o.Z)(ce,2),ve=de[0],pe=de[1];j.Y.debug("edit access = ",(null===(t=ue[0])||void 0===t||null===(v=t.questionnaire)||void 0===v?void 0:v.edit)&&ee["*"].includes("edit"));var he=function(e){var n,t,i;if("ERR_CANCELED"!==(null===e||void 0===e?void 0:e.code))if(401==(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.status))X({titleMessage:"Error",descriptionMessage:"Session Timeout: Please login again",messageType:"error"},(function(){return $.current()})),setTimeout((function(){ne("/login")}),3e3);else if(403===(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status)){var s,r,o,a;X({titleMessage:"Error",descriptionMessage:null!==e&&void 0!==e&&null!==(s=e.response)&&void 0!==s&&null!==(r=s.data)&&void 0!==r&&r.message?null===e||void 0===e||null===(o=e.response)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(function(){return $.current()})),setTimeout((function(){ne("/home")}),3e3)}else if(400===(null===e||void 0===e||null===(i=e.response)||void 0===i?void 0:i.status)&&"Invalid questionnaire!"===e.response.data.message){var l,u,c,d;X({titleMessage:"Error",descriptionMessage:null!==e&&void 0!==e&&null!==(l=e.response)&&void 0!==l&&null!==(u=l.data)&&void 0!==u&&u.message?null===e||void 0===e||null===(c=e.response)||void 0===c||null===(d=c.data)||void 0===d?void 0:d.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(function(){return $.current()})),setTimeout((function(){ne("/questionnaires")}),3e3)}else{var v,p;X({titleMessage:"Error",descriptionMessage:null!==e&&void 0!==e&&null!==(v=e.response)&&void 0!==v&&null!==(p=v.data)&&void 0!==p&&p.message&&"string"===typeof e.response.data.message?e.response.data.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(function(){return $.current()}))}},fe=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j.Y.debug("Questionnaire",se),e.next=4,B().delete(E.ZW+"/".concat(null===se||void 0===se?void 0:se.uuid),{data:{deletionType:n}});case 4:return X({titleMessage:"Success",descriptionMessage:"".concat("inactive"===n?"Questionnaire inactivated successfully!":"Questionnaire deleted successfully!"),messageType:"success"},(function(){return $.current()})),e.abrupt("return",setTimeout((function(){return ne("/questionnaires",{state:0})}),3e3));case 8:e.prev=8,e.t0=e.catch(0),he(e.t0);case 11:return e.prev=11,W(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(n){return e.apply(this,arguments)}}(),me=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B().delete(E.uf+"/".concat(null===se||void 0===se?void 0:se.uuid));case 3:return n=e.sent,X({titleMessage:"Success",descriptionMessage:n.data.message,messageType:"success"},(function(){return $.current()})),e.abrupt("return",setTimeout((function(){return ne("/questionnaires",{state:1})}),3e3));case 8:e.prev=8,e.t0=e.catch(0),he(e.t0);case 11:return e.prev=11,W(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se&&null!==se&&void 0!==se&&se.isPublished?fe("delete"):me();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,q.jsxs)("div",{className:"page-wrapper",onClick:function(){return ve&&pe(!1)},children:[(0,q.jsx)(H.Z,{title:(0,q.jsxs)("p",{children:[" ","Delete ",se&&!(null!==se&&void 0!==se&&se.isPublished)&&" Drafted ","Questionnaire"]}),info1:(0,q.jsx)("p",{children:se&&null!==se&&void 0!==se&&se.isPublished?"Deleting the questionnaire will also delete the related assessments. Instead we recommend you make the questionnaire inactive.":"Deleting the drafted questionnaire will be an irreversible action. All the related details would be lost."}),info2:(0,q.jsxs)("p",{children:["Are you sure you want to delete",se&&!(null!==se&&void 0!==se&&se.isPublished)&&" drafted"," the questionnaire?"]}),primaryButtonText:se&&null!==se&&void 0!==se&&se.isPublished?"Delete Anyway":"Delete",secondaryButtonText:se&&null!==se&&void 0!==se&&se.isPublished?"Inactive":"Cancel",onPrimaryModalButtonClickHandler:xe,onSecondaryModalButtonClickHandler:function(){se&&null!==se&&void 0!==se&&se.isPublished?fe("inactive"):W(!1)},openModal:F,setOpenModal:W}),(0,q.jsx)(A.Z,{myRef:$,titleMessage:J.titleMessage,descriptionMessage:J.descriptionMessage,messageType:J.messageType}),(0,q.jsx)("div",{className:"breadcrumb-wrapper",children:(0,q.jsx)("div",{className:"container",children:(0,q.jsxs)("ul",{className:"breadcrumb",children:[(0,q.jsx)("li",{children:(0,q.jsxs)(C.rU,{to:"/questionnaires",style:{cursor:"pointer"},state:null!==se&&void 0!==se&&se.isPublished?0:1,children:["Questionnaire"," ",null!==se&&void 0!==se&&se.isPublished?"(Published)":"(Drafted)"]})}),ee["*"].includes("version")&&(0,q.jsx)("li",{children:(0,q.jsx)(C.rU,{to:"/questionnaire-version-history/".concat(ee.id),style:{cursor:"pointer"},children:"Questionnaire History"})}),ee["*"].includes("version")?(0,q.jsx)("li",{children:"Preview Questionnaire History"}):(0,q.jsx)("li",{children:"Preview Questionnaire "})]})})}),(0,q.jsx)("section",{children:(0,q.jsxs)("div",{className:"container",children:[(0,q.jsxs)("div",{className:"form-header",children:[(0,q.jsxs)("div",{className:"flex-between preview-que-ttl-blk",children:[(0,q.jsx)("h2",{className:"heading2",children:null===se||void 0===se?void 0:se.title}),(0,q.jsxs)("span",{className:"form-header-right-txt",onClick:function(){pe(!ve)},children:[(0,q.jsx)("span",{className:"crud-operation ".concat(ve&&"crud-operation-active"),children:(0,q.jsx)(Q.Z,{})}),(0,q.jsx)("div",{className:"crud-toggle-wrap que-crud-toggle-wrap",style:{display:ve?"block":"none"},children:(0,q.jsxs)("ul",{className:"crud-toggle-list",children:[(0,q.jsx)("li",{onClick:function(){return(0,z.j)("Questionnaire",X,ee.id,$,E.KW,ne)},children:"Export to Excel"}),!ee["*"].includes("version")&&!(null!==se&&void 0!==se&&se.isDraft)&&(0,q.jsx)("li",{onClick:function(){return ne("/questionnaire-version-history/".concat(ee.id))},children:"Version History"}),(!0===le||(null===(p=ue[0])||void 0===p||null===(h=p.questionnaire)||void 0===h?void 0:h.edit))&&!ee["*"].includes("version")&&((null===se||void 0===se?void 0:se.isDraft)||(null===se||void 0===se?void 0:se.isPublished))&&(0,q.jsx)("li",{onClick:function(){return ne("/questionnaires/edit-questionnaire/".concat(ee.id))},children:"Edit Questionnaire"}),(!0===le||(null===(f=ue[0])||void 0===f||null===(m=f.questionnaire)||void 0===m?void 0:m.delete))&&(0,q.jsx)("li",{onClick:function(){return W(!0)},children:"Delete Questionnaire"})]})})]})]}),(0,q.jsx)("div",{className:"excel-short-name",children:(0,q.jsx)("p",{children:null===se||void 0===se?void 0:se.sheetName})})]}),T?(0,q.jsx)(U.Z,{}):(0,q.jsxs)("div",{className:"section-form-sect",children:[(0,q.jsx)("div",{className:"section-tab-blk flex-between preview-tab-blk",children:(0,q.jsx)("div",{className:"section-tab-leftblk",children:(0,q.jsx)(l.Z,{sx:{borderBottom:1,borderColor:"divider"},className:"tabs-sect que-tab-sect",children:(0,q.jsx)(u.Z,{value:y,onChange:function(e,n){Z(n)},"aria-label":"basic tabs example",variant:"scrollable",scrollButtons:"auto",children:null===se||void 0===se||null===(x=se.sections)||void 0===x?void 0:x.map((function(e,n,t){var i;return(0,q.jsx)(c.Z,{title:e.sectionTitle,placement:"bottom-start",children:(0,q.jsx)(d.Z,(0,s.Z)({className:"section-tab-item",label:"section ".concat(n+1)},L(n)))},null!==(i=null===e||void 0===e?void 0:e.uuid)&&void 0!==i?i:t)}))})})})}),(0,q.jsx)("div",{className:"preview-tab-data",children:null===se||void 0===se||null===(g=se.sections)||void 0===g?void 0:g.map((function(e,n){var t;return(0,q.jsx)(_.x,{value:y,index:n,children:(0,q.jsx)(D,{questionnaire:se,section:e,sectionIndex:n})},null!==(t=null===e||void 0===e?void 0:e.uuid)&&void 0!==t?t:n)}))})]})]})})]})}},7806:function(e,n,t){t.d(n,{d:function(){return l},j:function(){return u}});var i=t(4165),s=t(5861),r=t(4677),o=t(4917),a=t(5736),l=function(){var e=(new Date).getMonth()<10?"0"+((new Date).getMonth()+1).toString():(new Date).getMonth().toString(),n=(new Date).getDate()<10?"0"+(new Date).getDate().toString():(new Date).getDate().toString(),t=(new Date).getHours();return e+n+(new Date).getFullYear().toString()+"_"+t+(new Date).getMinutes()+(new Date).getSeconds()},u=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(n,t,s,u,c,d){var v,p,h,f;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.Y.debug("navigate = ",d),e.prev=1,e.next=4,r.H.get(s?c+s+"/download":c,{responseType:"blob"});case 4:v=e.sent,o.Y.debug("resposne from ".concat(n,"  assessment "),v),p=window.URL.createObjectURL(new Blob([v.data])),(h=document.createElement("a")).href=p,f=l(),h.setAttribute("download","".concat(n," - ").concat(f,".xlsx")),document.body.appendChild(h),h.click(),200==v.status&&t({titleMessage:"Success!",descriptionMessage:"Downloaded Successfully!",messageType:"success"},(function(){return u.current()})),e.next=21;break;case 16:return e.prev=16,e.t0=e.catch(1),o.Y.debug("Error from ".concat(n,"  Assessment"),e.t0),(0,a.K)(e.t0,t,u,d),e.abrupt("return",e.t0);case 21:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(n,t,i,s,r,o){return e.apply(this,arguments)}}()},2898:function(e,n,t){var i=t(4836);n.Z=void 0;var s=i(t(5649)),r=t(184),o=(0,s.default)((0,r.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert");n.Z=o}}]);
//# sourceMappingURL=8177.e0e57ebb.chunk.js.map