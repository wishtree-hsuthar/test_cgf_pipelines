"use strict";(self.webpackChunkpr74_cgf_hrdd_web_front=self.webpackChunkpr74_cgf_hrdd_web_front||[]).push([[6035],{26035:(e,s,n)=>{n.r(s),n.d(s,{default:()=>j});var i=n(72791),t=n(57689),l=n(53073),a=n(59434),o=n(94677),d=n(76218),r=n(12820),c=n(1260),u=n(77194),m=n(27659),v=n(28386),h=n(14917),g=n(45736),p=n(80184);const b={width:"30%",disablePadding:!1},x=[{...b,id:"title",label:"Title"},{...b,id:"assessmentType",label:"Assessment Type"},{...b,id:"assignedMember.name",label:"Assigned Member"},{...b,id:"assignedOperationMember.name",label:"Assigned To"},{...b,id:"region",label:"Region"},{...b,id:"country",label:"Country"},{...b,id:"assessmentStatus",label:"Status"},{...b,id:"submissionDate",label:"Submitted Date"},{...b,id:"dueDate",label:"Due Date"},{...b,id:"action",label:"Actions"}],j=()=>{var e,s,n,b;(0,c.j)("Assessments");const j=i.useRef(),[f,y]=(0,r.Z)({titleMessage:"",descriptionMessage:"",messageType:"success"}),w=["uuid","_id","title","assessmentType","assignedMember.name","assignedOperationMember.name","region","country","assessmentStatus","submissionDate","dueDate","isUserAuthorizedToFillAssessment"],k=(0,t.s0)(),[A,C]=(0,i.useState)(!1),[N,D]=(0,i.useState)(null),[S,Z]=(0,i.useState)(!0),[M,T]=(0,i.useState)(""),[O,P]=(0,i.useState)(1),[_,R]=(0,i.useState)(10),[E,F]=(0,i.useState)("desc"),[B,U]=(0,i.useState)(""),[I,H]=(0,i.useState)([]),[L,q]=(0,i.useState)(0);let z=["download"];const K=async function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new AbortController;try{let s=(()=>{let e="".concat(d.jE,"?page=").concat(O,"&size=").concat(_,"&orderBy=").concat(B,"&order=").concat(E);return(null===M||void 0===M?void 0:M.length)>=3&&(e+="&search=".concat(M)),e})();C(!0);const n=await o.H.get(s,{signal:e.signal});q(parseInt(n.headers["x-total-count"])),V([...n.data]),C(!1)}catch(v){var s,n;if("ERR_CANCELED"===(null===v||void 0===v?void 0:v.code))return;if(401==(null===v||void 0===v||null===(s=v.response)||void 0===s?void 0:s.status))y({titleMessage:"Error",descriptionMessage:"Session Timeout: Please login again",messageType:"error"},(()=>j.current())),setTimeout((()=>{k("/login")}),3e3);else if(403==(null===v||void 0===v||null===(n=v.response)||void 0===n?void 0:n.status)){var i,t,l,a;y({titleMessage:"Error",descriptionMessage:null!==v&&void 0!==v&&null!==(i=v.response)&&void 0!==i&&null!==(t=i.data)&&void 0!==t&&t.message?null===v||void 0===v||null===(l=v.response)||void 0===l||null===(a=l.data)||void 0===a?void 0:a.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>j.current())),setTimeout((()=>{k("/home")}),3e3)}else{var r,c,u,m;y({titleMessage:"Error",descriptionMessage:null!==v&&void 0!==v&&null!==(r=v.response)&&void 0!==r&&null!==(c=r.data)&&void 0!==c&&c.message?null===v||void 0===v||null===(u=v.response)||void 0===u||null===(m=u.data)||void 0===m?void 0:m.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>j.current()))}C(!1)}},V=e=>{e.forEach((e=>{var s,n,i,t;delete e.updatedAt,delete e.__v,delete e.isDraft,delete e.isPublished,delete e.isActive,delete e.isDeleted,delete e.isSubmitted,delete e.updatedAt,delete e.updatedBy,delete e.createdBy,delete e.createdAt,delete e.remarks,e["assignedMember.name"]=null!==(s=null===e||void 0===e||null===(n=e.assignedMember)||void 0===n?void 0:n.name)&&void 0!==s?s:"N/A",e["assignedOperationMember.name"]=null!==(i=null===e||void 0===e||null===(t=e.assignedOperationMember)||void 0===t?void 0:t.name)&&void 0!==i?i:"N/A",e.isUserAuthorizedToFillAssessment=J._id===e.assignedOperationMember._id,delete e.assignedOperationMember,delete e.assignedMember,delete e.memberCompany,delete e.questionnaireId,delete e.isMemberRepresentative,delete e.actionPlan,e.dueDate=new Date(new Date(e.dueDate).setDate(new Date(e.dueDate).getDate()-1)).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}),e.submissionDate=e.submissionDate?new Date(new Date(e.submissionDate).setDate(new Date(e.submissionDate).getDate()-1)).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"N/A",w.forEach((s=>{const n=e[s];delete e[s],e[s]=n}))})),H([...e])};(0,i.useEffect)((()=>{let e=!0;const s=new AbortController;return S&&K(e,s),()=>{e=!1,clearTimeout(N),s.abort()}}),[O,_,B,E,S]);const Y=(0,a.v9)((e=>{var s;return null===e||void 0===e||null===(s=e.user)||void 0===s?void 0:s.privilege})),J=(0,a.v9)((e=>{var s;return null===e||void 0===e||null===(s=e.user)||void 0===s?void 0:s.userObj})),Q="Super Admin"===(null===Y||void 0===Y?void 0:Y.name);let W=("Super Admin"===(null===J||void 0===J||null===(e=J.roleId)||void 0===e?void 0:e.name)?[]:Object.values(null===Y||void 0===Y?void 0:Y.privileges)).filter((e=>{var s;return"Assessment"===(null===e||void 0===e||null===(s=e.moduleId)||void 0===s?void 0:s.name)})).map((e=>({assessment:{list:null===e||void 0===e?void 0:e.list,visibility:null===e||void 0===e?void 0:e.view,edit:null===e||void 0===e?void 0:e.edit,add:null===e||void 0===e?void 0:e.add,fill:null===e||void 0===e?void 0:e.fill}}))),G={...null===(s=W[0])||void 0===s?void 0:s.assessment};return(0,p.jsxs)("div",{children:[(0,p.jsx)(m.Z,{messageType:f.messageType,descriptionMessage:f.descriptionMessage,myRef:j,titleMessage:f.titleMessage}),(0,p.jsx)("div",{className:"page-wrapper",children:(0,p.jsx)("section",{children:(0,p.jsxs)("div",{className:"container",children:[(0,p.jsxs)("div",{className:"form-header member-form-header flex-between mb-0",children:[(0,p.jsx)("div",{className:"form-header-left-blk flex-start",children:(0,p.jsx)("h2",{className:"heading2 mr-40",children:"Assessments"})}),(0,p.jsxs)("div",{className:"form-header-right-txt search-and-btn-field-right view-instruct-field-right",children:[(0,p.jsx)("div",{className:"search-and-btn-field-blk mr-0",children:(0,p.jsxs)("div",{className:"searchbar",children:[(0,p.jsx)("input",{type:"text",value:M,name:"search",placeholder:"Search",onKeyDown:e=>{"Enter"===e.key&&(Z(!0),P(1))},onChange:e=>{h.Y.info("Assessment list - onSearchChangeHandler handler"),N&&clearTimeout(N),Z(!1),T(e.target.value),D(setTimeout((()=>{Z(!0),P(1)}),1e3))}}),(0,p.jsx)("button",{type:"submit",children:(0,p.jsx)("i",{className:"fa fa-search"})})]})}),(Q||(null===(n=W[0])||void 0===n||null===(b=n.assessment)||void 0===b?void 0:b.add))&&(0,p.jsx)("div",{className:"form-btn ml-20",children:(0,p.jsx)("button",{type:"submit",className:"primary-button add-button",onClick:()=>{k("/assessment-list/add-assessment")},children:"Add Assessment"})}),(0,p.jsxs)("div",{className:"tertiary-btn-blk ml-20",onClick:()=>{k("/assessment-list/instructions")},children:[(0,p.jsx)("span",{className:"preview-icon",children:(0,p.jsx)(u.Z,{})}),(0,p.jsx)("span",{className:"addmore-txt",children:"View Instructions"})]})]})]}),(0,p.jsx)("div",{className:"member-info-wrapper table-content-wrap",children:(0,p.jsx)("div",{className:"member-info-wrapper table-content-wrap table-footer-btm-space assessment-list-table",children:A?(0,p.jsx)(v.Z,{}):(0,p.jsx)(l.Z,{tableHead:x,records:I,handleChangePage1:e=>{P(e)},handleChangeRowsPerPage1:e=>{R(parseInt(e.target.value,10)),P(1)},page:O,rowsPerPage:_,totalRecords:L,orderBy:B,icons:(()=>{Object.entries(G).filter((e=>!0===e[1]&&z.push(e[0])));return console.log("icons - assessment",z),Q?(z=["edit","visibility","download"],z):z.includes("fill")?(z.push("send"),z.push("download"),z):z})(),onClickVisibilityIconHandler1:e=>k("/assessment-list/view-assessment/".concat(e)),onClickEditAssesmentFunction:e=>k("/assessment-list/edit-assessment/".concat(e)),order:E,setOrder:F,setOrderBy:U,setCheckBoxes:!1,onClickAssignAssesmentFunction:e=>k("/assessment-list/assign-assessment/".concat(e)),onClickFillAssessmentFunction:e=>k("/assessment-list/fill-assessment/".concat(e)),viewAssessment:!0,onClickActionPlanDownload:async e=>{try{const s=await o.H.get(d.qK+e+"/action-plan",{responseType:"blob"});h.Y.info(" download function -  from   assessment "),console.log("response-download = ",s);const n=window.URL.createObjectURL(new Blob([s.data])),i=document.createElement("a");i.href=n,i.setAttribute("download","".concat(s.headers["file-name"])),document.body.appendChild(i),i.click(),200==s.status&&(console.log("response from download",s),y({titleMessage:"Success!",descriptionMessage:"Downloaded Successfully!",messageType:"success"},(()=>j.current())))}catch(s){if(s.response){let e=new FileReader;e.onload=function(){let s=JSON.parse(e.result);(0,g.K)(s,y,j,k)},console.log(e.readAsText(s.response.data))}else s.request?console.log(s.request):console.log("Error",s.message)}}})})})]})})})]})}},53073:(e,s,n)=>{n.d(s,{Z:()=>N});var i=n(7195),t=n(59140),l=n(77194),a=n(697),o=n(94454),d=n(35527),r=n(79836),c=n(53382),u=n(53994),m=n(39281),v=n(56890),h=n(35855),g=n(80720),p=(n(72791),n(50922)),b=n(61419),x=n(96816),j=(n(14917),n(20068)),f=n(58406),y=n(63903),w=n(53767),k=n(57246),A=(n(71605),n(80184));function C(e){const{onSelectAllClick:s,order:n,orderBy:i,tableHead:t,numSelected:l,rowCount:a,onRequestSort:d,setCheckBoxes:r}=e;return(0,A.jsx)(v.Z,{children:(0,A.jsxs)(h.Z,{children:[r&&(0,A.jsx)(u.Z,{padding:"checkbox",className:"table-checkbox",children:(0,A.jsx)(o.Z,{color:"primary",indeterminate:l>0&&l<a,checked:a>0&&l===a,onChange:s,inputProps:{"aria-label":"select all desserts"},className:"checkbox-mui"})}),t.map((e=>{return(0,A.jsxs)(u.Z,{width:null===e||void 0===e?void 0:e.width,align:"left",padding:e.disablePadding?"none":"normal",className:"table-header",children:["action"!==e.id&&(0,A.jsx)(g.Z,{active:i===e.id,direction:i===e.id?n:"asc",onClick:(s=e.id,e=>{d(e,s)}),className:"sorted-blk",children:e.label}),"action"===e.id&&(0,A.jsx)("span",{className:"sorted-blk",children:e.label})]},e.id);var s}))]})})}function N(e){let{tableHead:s,records:n,page:v=1,rowsPerPage:g=10,handleChangeRowsPerPage1:N,handleChangePage1:D,totalRecords:S,orderBy:Z,setOrderBy:M,icons:T,onClickVisibilityIconHandler1:O,onClickDeleteIconHandler1:P,selected:_=[],setSelected:R,order:E="asc",setOrder:F,setCheckBoxes:B=!0,setSingleSelect:U=!1,handleSingleUserSelect:I,selectedUser:H,onRowClick:L=!1,isQuestionnare:q=!1,onClickEditAssesmentFunction:z,onClickAssignAssesmentFunction:K,onClickFillAssessmentFunction:V,viewAssessment:Y=!1,onClickActionPlanDownload:J}=e;console.log("icons - ",T);const Q=(e,s)=>{O(e,s||!1)};return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(a.Z,{sx:{width:"100%"},className:B?"table-blk":"table-blk table-blk-without-checkbox",children:(0,A.jsx)(d.Z,{sx:{width:"100%",mb:2},children:(0,A.jsx)(m.Z,{children:(0,A.jsxs)(r.Z,{sx:{minWidth:750},"aria-labelledby":"tableTitle",children:[(0,A.jsx)(C,{numSelected:_.length,order:E,orderBy:Z,tableHead:s,onSelectAllClick:e=>{if(e.target.checked){const e=n.map((e=>e._id));R(e)}else R([])},onRequestSort:(e,s)=>{F(Z===s&&"asc"===E?"desc":"asc"),M(s)},rowCount:n.length,setCheckBoxes:B}),(null===n||void 0===n?void 0:n.length)>0?(0,A.jsx)(c.Z,{children:n.map(((e,s)=>{const n=(a=e._id,-1!==_.indexOf(a));var a;const d="enhanced-table-checkbox-".concat(s);return(0,A.jsxs)(h.Z,{hover:!0,onClick:()=>L&&Q(q?e.uuid:e._id,(null===e||void 0===e?void 0:e.isOperationMember)||(null===e||void 0===e?void 0:e.isMemberRepresentative)),style:{cursor:L&&"pointer"},role:"checkbox","aria-checked":n,tabIndex:-1,selected:n,children:[B&&(0,A.jsx)(u.Z,{padding:"checkbox",children:(0,A.jsx)(o.Z,{className:"table-checkbox",color:"primary",onClick:s=>((e,s)=>{const n=_.indexOf(s);let i=[];-1===n?i=i.concat(_,s):0===n?i=i.concat(_.slice(1)):n===_.length-1?i=i.concat(_.slice(0,-1)):n>0&&(i=i.concat(_.slice(0,n),_.slice(n+1))),R(i)})(0,e._id),checked:n,inputProps:{"aria-labelledby":d}})}),U&&(0,A.jsx)(u.Z,{children:(0,A.jsx)("div",{className:"radio-btn-field",children:(0,A.jsx)(b.Z,{className:"radio-btn",color:"primary",value:e._id,onChange:()=>(e=>{I(e)})(e._id),checked:H==e._id,inputProps:{"aria-labelledby":d}})})}),Object.keys(e).map(((s,n)=>{var i,t,l,a,o,d,r,c,m;return"_id"!==s&&"uuid"!==s&&"isActive"!==s&&"isUserAuthorizedToFillAssessment"!==s&&"isOperationMember"!==s&&"isMemberRepresentative"!==s&&"dueDate"!==s&&"submissionDate"!==s&&"title"!==s?(console.log("cell",s),(null===(i=e[s])||void 0===i?void 0:i.length)<=28||"undefined"===typeof e[s]?(0,A.jsxs)(u.Z,{children:[" ",("undefined"===typeof e[s]||""===e[s])&&"N/A","string"===typeof e[s]&&(null===(t=e[s])||void 0===t?void 0:t.length)>0&&"email"!==s?e[s][0].toUpperCase()+(null===(l=e[s])||void 0===l?void 0:l.slice(1)):e[s]]},s):(0,A.jsx)(j.Z,{placement:"bottom-start",enterDelay:1e3,title:e[s],children:(0,A.jsx)(u.Z,{children:"string"===typeof e[s]&&"email"!==s?e[s][0].toUpperCase()+"".concat(null===(a=e[s])||void 0===a?void 0:a.slice(1,28),"..."):"".concat(null===(o=e[s])||void 0===o?void 0:o.slice(0,28),"...")},s)},s)):"title"===s?(0,A.jsx)(j.Z,{placement:"bottom-start",enterDelay:1e3,title:e[s],children:(0,A.jsx)(u.Z,{children:"string"===typeof e[s]&&(null===(d=e[s])||void 0===d?void 0:d.length)>0&&"title"===s?e[s][0].toUpperCase()+(null===(r=e[s])||void 0===r?void 0:r.slice(1)):e[s]},s)},s):"isActive"===s?(0,A.jsx)(u.Z,{className:"button-style ".concat(e[s]&&"button-style-success"),children:(0,A.jsx)("span",{children:e[s]?"Active":"Inactive"})},s):"dueDate"===s?(0,A.jsx)(u.Z,{className:"due-date-style ".concat(new Date(new Date(e[s]).toLocaleDateString("en")).getTime()>=new Date((new Date).toLocaleDateString("en")).getTime()&&"due-date-style-success"),children:(0,A.jsx)("span",{children:null!==(c=e[s])&&void 0!==c?c:e[s]})},s):"submissionDate"===s?(0,A.jsx)(u.Z,{style:{textAlign:"center"},children:(0,A.jsx)("span",{children:null!==(m=e[s])&&void 0!==m?m:e[s]})},s):void 0})),(null===T||void 0===T?void 0:T.length)>0&&(0,A.jsxs)(u.Z,{children:[T.includes("visibility")&&(0,A.jsx)("span",{className:"icon",children:(0,A.jsx)(j.Z,{title:"View Assessment",children:(0,A.jsx)(l.Z,{onClick:()=>Q(Y?e.uuid:e._id)})})}),T.includes("delete")&&(0,A.jsx)("span",{className:"icon",children:(0,A.jsx)(j.Z,{title:"Delete",children:(0,A.jsx)("img",{src:"/images/delete-icon.svg",onClick:()=>(e=>{P(e)})(e._id)})})}),T.includes("edit")&&(0,A.jsx)("span",{className:"icon",children:(0,A.jsx)(j.Z,{title:"Edit",children:(0,A.jsx)(i.Z,{onClick:()=>{return s=e.uuid,void z(s);var s}})})}),T.includes("send")&&("In Progress"==(null===e||void 0===e?void 0:e.assessmentStatus)||"Re-opened"==(null===e||void 0===e?void 0:e.assessmentStatus)||"Accepted"==(null===e||void 0===e?void 0:e.assessmentStatus))&&e.isUserAuthorizedToFillAssessment&&(0,A.jsx)("span",{className:"icon",children:(0,A.jsx)(j.Z,{title:"Assign to Operation Member",children:(0,A.jsx)(p.Z,{onClick:()=>K(e.uuid)})})}),T.includes("fill")&&e.isUserAuthorizedToFillAssessment&&(0,A.jsx)("span",{className:"icon",children:(0,A.jsx)(j.Z,{title:"Fill Assessment",children:(0,A.jsx)(t.Z,{onClick:()=>{return s=e.uuid,void V(s);var s}})})}),T.includes("download")&&(0,A.jsx)("span",{className:"icon",children:(0,A.jsx)(j.Z,{title:"Action plan",children:(0,A.jsx)(x.Z,{onClick:()=>{return s=e.uuid,void J(s);var s}})})})]})]},null===e||void 0===e?void 0:e._id)}))}):(0,A.jsx)(c.Z,{children:(0,A.jsx)("tr",{children:(0,A.jsx)("td",{colSpan:"10",children:(0,A.jsx)("div",{className:"no-records-blk",children:(0,A.jsx)("h2",{className:"heading2",children:"No records available"})})})})})]})})})}),(null===n||void 0===n?void 0:n.length)>0&&(0,A.jsxs)("div",{className:"table-footer flex-between",children:[(0,A.jsxs)("div",{className:"table-footer-left",children:[(0,A.jsxs)("div",{className:"per-page-blk",children:[(0,A.jsx)("span",{className:"per-page-txt",children:"Records"}),(0,A.jsx)("div",{className:"per-page-dropdown",children:(0,A.jsx)("div",{className:"per-page-select-field",children:(0,A.jsxs)(f.Z,{value:g,onChange:e=>{N(e)},children:[(0,A.jsx)(y.Z,{value:"5",children:"05"}),(0,A.jsx)(y.Z,{value:"10",selected:!0,children:"10"}),(0,A.jsx)(y.Z,{value:"20",children:"20"})]})})})]}),(0,A.jsxs)("div",{className:"show-entries-txt",children:["showing ",(v-1)*g+1,"-",(v-1)*g+(null===n||void 0===n?void 0:n.length)," out of ",S]})]}),(0,A.jsx)("div",{className:"table-footer-right",children:(0,A.jsx)(w.Z,{spacing:2,className:"pagination-blk",children:(0,A.jsx)(k.Z,{page:v,count:Math.ceil(S/g),onChange:(e,s)=>{D(s)},variant:"outlined",shape:"rounded"})})})]})]})}},45736:(e,s,n)=>{n.d(s,{K:()=>i});const i=async function(e,s,n,i,t){var l,a;let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if("ERR_CANCELED"===(null===e||void 0===e?void 0:e.code))return null;if(401==(null===e||void 0===e||null===(l=e.response)||void 0===l?void 0:l.status))s({titleMessage:"Oops!",descriptionMessage:"Session Timeout: Please login again!",messageType:"error"},(()=>n.current())),setTimeout((()=>{i("/login")}),3e3);else if(403===(null===e||void 0===e||null===(a=e.response)||void 0===a?void 0:a.status)){var d,r,c,u;s({titleMessage:"Oops!",descriptionMessage:null!==e&&void 0!==e&&null!==(d=e.response)&&void 0!==d&&null!==(r=d.data)&&void 0!==r&&r.message?null===e||void 0===e||null===(c=e.response)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>n.current())),setTimeout((()=>{i("/home")}),3e3)}else{var m,v,h,g;console.log("error - ",e),s({titleMessage:"Oops!",descriptionMessage:null!==e&&void 0!==e&&null!==(m=e.response)&&void 0!==m&&null!==(v=m.data)&&void 0!==v&&v.message?null===e||void 0===e||null===(h=e.response)||void 0===h||null===(g=h.data)||void 0===g?void 0:g.message:null!==e&&void 0!==e&&e.message?"File not uploaded yet":"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>n.current())),t&&setTimeout((()=>{i(t,{state:o})}),3e3)}}},1260:(e,s,n)=>{n.d(s,{j:()=>t});var i=n(72791);const t=e=>((0,i.useEffect)((()=>{document.title="HRDD System - ".concat(e)}),[e]),null)}}]);
//# sourceMappingURL=6035.785422fa.chunk.js.map