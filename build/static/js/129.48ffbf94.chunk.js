"use strict";(self.webpackChunkpr74_cgf_hrdd_web_front=self.webpackChunkpr74_cgf_hrdd_web_front||[]).push([[129],{5248:function(e,t,r){r.r(t);var n=r(4942),a=r(4165),i=r(5861),s=r(1413),l=r(885),c=r(8588),o=r(7265),d=r(2900),u=r(6321),m=r(6015),h=r(6650),p=r(9963),f=r(1680),x=r(9773),v=r(807),Z=r(4390),b=r(5473),g=r(2791),j=r(1134),k=r(7689),N=r(1087),w=r(4569),y=r.n(w),C=r(8386),M=r(4917),S=r(7444),T=(r(1605),r(2820)),E=r(6218),z=r(1260),A=r(4227),L=r(5736),R=r(184);t.default=function(){(0,z.j)("Add Role");var e=(0,k.s0)(),t=g.useRef(),r=(0,T.Z)({titleMessage:"",descriptionMessage:"",messageType:"success"}),w=(0,l.Z)(r,2),O=w[0],P=w[1],I=function(e){var r,n;M.Y.debug("error",e),P({titleMessage:"Error",descriptionMessage:null!==e&&void 0!==e&&null!==(r=e.response)&&void 0!==r&&null!==(n=r.data)&&void 0!==n&&n.message&&"string"===typeof e.response.data.message?e.response.data.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(function(){return t.current()}))},_=[],V={},q={roleName:"",status:"active",description:""},H={roleName:{required:"Enter the role name",maxLength:"Max char limit exceed",minLength:"minimum 3 characters required",pattern:"Invalid format"},description:{required:"Enter the description",maxLength:"Max char limit exceed",minLength:"minimum 3 characters required"}},Y=(0,g.useState)((0,s.Z)({},V)),B=(0,l.Z)(Y,2),F=B[0],Q=B[1],D=(0,g.useState)(!1),J=(0,l.Z)(D,2),K=J[0],U=J[1],W=(0,g.useState)(!1),$=(0,l.Z)(W,2),G=$[0],X=$[1],ee=function(e){e.map((function(e,t){return _[t]={moduleName:e.name,moduleId:e._id}})),_.forEach((function(e){return V[e.moduleId]={name:e.moduleName,fill:!1,list:!1,add:!1,edit:!1,view:!1,delete:!1,all:!1}})),Q((0,s.Z)({},V))},te=(0,j.cI)({defaultValues:q}),re=te.control,ne=te.reset,ae=te.setValue,ie=te.handleSubmit,se=function(e){return Object.values(e).some((function(e){return Object.values(e).some((function(e){return e}))}))},le=function(){var r=(0,i.Z)((0,a.Z)().mark((function r(n){var i,l,c,o,d,u,m,h;return(0,a.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(M.Y.debug("inside on Submit"),r.prev=1,i=JSON.parse(JSON.stringify(F)),M.Y.debug("previleges for backend:- ",i),Object.keys(i).forEach((function(e){delete i[e].all,delete i[e].name})),M.Y.debug("isValid Previleges:- ",se(i)),se(i)){r.next=9;break}return P({titleMessage:"Hurray!",descriptionMessage:"Select atleast 1 privilege",messageType:"error"},(function(){return t.current()})),r.abrupt("return");case 9:return U(!0),X(!0),r.next=13,y().post(E.Yn+"roles",{name:n.roleName,description:n.description,isActive:"active"===n.status,privileges:i});case 13:if(201!=(l=r.sent).status){r.next=21;break}return X(!1),U(!1),P({titleMessage:"Hurray!",descriptionMessage:l.data.message,messageType:"success"},(function(){return t.current()})),ne((0,s.Z)({},q)),de(),r.abrupt("return",!0);case 21:r.next=39;break;case 23:if(r.prev=23,r.t0=r.catch(1),X(!1),U(!1),401!=(null===r.t0||void 0===r.t0||null===(c=r.t0.response)||void 0===c?void 0:c.status)){r.next=32;break}P({titleMessage:"Error",descriptionMessage:"Session Timeout: Please login again",messageType:"error"},(function(){return t.current()})),setTimeout((function(){e("/login")}),3e3),r.next=39;break;case 32:if(403!==(null===r.t0||void 0===r.t0||null===(o=r.t0.response)||void 0===o?void 0:o.status)){r.next=37;break}P({titleMessage:"Error",descriptionMessage:null!==r.t0&&void 0!==r.t0&&null!==(d=r.t0.response)&&void 0!==d&&null!==(u=d.data)&&void 0!==u&&u.message?null===r.t0||void 0===r.t0||null===(m=r.t0.response)||void 0===m||null===(h=m.data)||void 0===h?void 0:h.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(function(){return t.current()})),setTimeout((function(){e("/home")}),3e3),r.next=39;break;case 37:return I(r.t0),r.abrupt("return",!1);case 39:case"end":return r.stop()}}),r,null,[[1,23]])})));return function(e){return r.apply(this,arguments)}}(),ce=function(){var t=(0,i.Z)((0,a.Z)().mark((function t(r){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,le(r);case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:setTimeout((function(){return e("/roles")}),3e3);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),oe=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:le(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var r=(0,i.Z)((0,a.Z)().mark((function r(){var n,i;return(0,a.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,y().get(E.Yn+"system-modules");case 3:n=r.sent,i=n.data,ee(i),r.next=13;break;case 8:if(r.prev=8,r.t0=r.catch(0),"ERR_CANCELED"!==(null===r.t0||void 0===r.t0?void 0:r.t0.code)){r.next=12;break}return r.abrupt("return");case 12:(0,L.K)(r.t0,P,t,e);case 13:case"end":return r.stop()}}),r,null,[[0,8]])})));return function(){return r.apply(this,arguments)}}();return(0,g.useEffect)((function(){var e=!0,t=new AbortController;return e&&de(),function(){e=!1,t.abort()}}),[]),(0,R.jsxs)("div",{className:"page-wrapper",children:[(0,R.jsx)(S.Z,{myRef:t,titleMessage:O.titleMessage,descriptionMessage:O.descriptionMessage,messageType:O.messageType}),(0,R.jsx)("div",{className:"breadcrumb-wrapper",children:(0,R.jsx)("div",{className:"container",children:(0,R.jsxs)("ul",{className:"breadcrumb",children:[(0,R.jsx)("li",{children:(0,R.jsx)(N.rU,{to:"/roles",children:"Roles"})}),(0,R.jsx)("li",{children:"Add Role"})]})})}),(0,R.jsx)("section",{children:(0,R.jsxs)("div",{className:"container",children:[(0,R.jsxs)("div",{className:"form-header flex-between",children:[(0,R.jsx)("h2",{className:"heading2",children:"Add Role"}),(0,R.jsx)("div",{className:"form-header-right-txt",children:(0,R.jsxs)("div",{className:"tertiary-btn-blk",onClick:ie(oe),children:[(0,R.jsx)("span",{className:"addmore-icon",children:(0,R.jsx)("i",{className:"fa fa-plus"})}),(0,R.jsx)("span",{className:"addmore-txt",children:"Save & Add More"})]})})]}),(0,R.jsx)("form",{onSubmit:ie(ce),children:G?(0,R.jsx)(C.Z,{}):(0,R.jsxs)("div",{className:"card-wrapper",children:[(0,R.jsxs)("div",{className:"card-blk flex-between",children:[(0,R.jsx)("div",{className:"card-form-field",children:(0,R.jsxs)("div",{className:"form-group",children:[(0,R.jsxs)("label",{htmlFor:"roleName",children:["Role Name ",(0,R.jsx)("span",{className:"mandatory",children:"*"})]}),(0,R.jsx)(j.Qr,{name:"roleName",rules:{required:!0,maxLength:50,minLength:3,pattern:/^[a-zA-Z][a-zA-Z ]*$/},control:re,render:function(e){var t=e.field,r=e.fieldState.error;return(0,R.jsx)(c.Z,(0,s.Z)((0,s.Z)({},t),{},{onBlur:function(e){return ae("roleName",e.target.value.trim())},inputProps:{maxLength:50},className:"input-field ".concat(r&&"input-error"),id:"outlined-basic",placeholder:"Enter role name",helperText:r?H.roleName[r.type]:" ",variant:"outlined"}))}})]})}),(0,R.jsx)("div",{className:"card-form-field",children:(0,R.jsxs)("div",{className:"form-group",children:[(0,R.jsx)("label",{htmlFor:"status",children:"Status"}),(0,R.jsx)("div",{className:"radio-btn-field",children:(0,R.jsx)(j.Qr,{name:"status",control:re,render:function(e){var t=e.field;return(0,R.jsxs)(o.Z,(0,s.Z)((0,s.Z)({},t),{},{"aria-labelledby":"demo-radio-buttons-group-label",name:"radio-buttons-group",className:"radio-btn",children:[(0,R.jsx)(d.Z,{value:"active",control:(0,R.jsx)(u.Z,{}),label:"Active"}),(0,R.jsx)(d.Z,{value:"inactive",control:(0,R.jsx)(u.Z,{}),label:"Inactive"})]}))}})})]})}),(0,R.jsx)("div",{className:"card-form-field fullwidth",children:(0,R.jsxs)("div",{className:"form-group",children:[(0,R.jsxs)("label",{htmlFor:"addrole-description",children:["Description ",(0,R.jsx)("span",{className:"mandatory",children:"*"})]}),(0,R.jsx)(j.Qr,{name:"description",control:re,rules:{required:!0,maxLength:500,minLength:3},render:function(e){var t=e.field,r=e.fieldState.error;return(0,R.jsx)(c.Z,(0,s.Z)((0,s.Z)({multiline:!0},t),{},{onBlur:function(e){return ae("description",e.target.value.trim())},inputProps:{maxLength:500},className:"input-textarea ".concat(r&&"input-textarea-error"),id:"outlined-basic",placeholder:"Enter description",helperText:r?H.description[r.type]:" ",variant:"outlined"}))}})]})})]}),(0,R.jsx)(m.Z,{sx:{width:"100%"},className:"table-blk table-blk-role",children:(0,R.jsx)(h.Z,{sx:{width:"100%"},children:(0,R.jsx)(p.Z,{children:(0,R.jsxs)(f.Z,{sx:{minWidth:750},children:[(0,R.jsx)(A.Z,{}),(0,R.jsx)(x.Z,{children:Object.keys(F).map((function(e,t){return M.Y.debug("previleg",F[e].name),(0,R.jsxs)(v.Z,{hover:!0,children:[(0,R.jsx)(Z.Z,{children:F[e].name}),(0,R.jsx)(Z.Z,{align:"center",padding:"checkbox",children:"Assessment"===F[e].name&&(0,R.jsx)(b.Z,{disabled:"Assessment"!=F[e].name,className:"table-checkbox",checked:F[e].fill,onChange:function(){return Q((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},e,(0,s.Z)((0,s.Z)({},t[e]),{},{fill:!t[e].fill,list:t[e].list||!t[e].fill,view:t[e].view||!t[e].fill,all:!t[e].fill&&t[e].add&&t[e].edit&&t[e].delete})))}))}})}),(0,R.jsx)(Z.Z,{align:"center",padding:"checkbox",children:(0,R.jsx)(b.Z,{className:"table-checkbox",checked:F[e].list,onChange:function(){return Q((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},e,(0,s.Z)((0,s.Z)({},t[e]),{},{list:!t[e].list,view:t[e].view&&!t[e].list||!1,edit:t[e].edit&&!t[e].list||!1,delete:t[e].delete&&!t[e].list||!1,add:t[e].add&&!t[e].list||!1,fill:t[e].fill&&!t[e].list||!1,all:!t[e].list&&t[e].add&&t[e].edit&&t[e].view&&t[e].delete})))}))}})}),(0,R.jsx)(Z.Z,{align:"center",padding:"checkbox",children:(0,R.jsx)(b.Z,{className:"table-checkbox",checked:F[e].add,onChange:function(){return Q((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},e,(0,s.Z)((0,s.Z)({},t[e]),{},{add:!t[e].add,list:t[e].list||!t[e].add,view:t[e].view||!t[e].add,all:!t[e].add&&t[e].edit&&t[e].delete})))}))}})}),(0,R.jsx)(Z.Z,{align:"center",padding:"checkbox",children:(0,R.jsx)(b.Z,{className:"table-checkbox",checked:F[e].edit,onChange:function(){return Q((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},e,(0,s.Z)((0,s.Z)({},t[e]),{},{edit:!t[e].edit,list:t[e].list||!t[e].edit,view:t[e].view||!t[e].edit,all:t[e].add&&!t[e].edit&&t[e].delete})))}))}})}),(0,R.jsx)(Z.Z,{align:"center",padding:"checkbox",children:(0,R.jsx)(b.Z,{className:"table-checkbox",checked:F[e].view,onChange:function(){return Q((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},e,(0,s.Z)((0,s.Z)({},t[e]),{},{view:!t[e].view,list:t[e].list||!t[e].view,edit:t[e].edit&&!t[e].view||!1,delete:t[e].delete&&!t[e].view||!1,fill:t[e].fill&&!t[e].view||!1,all:t[e].add&&t[e].edit&&!t[e].view&&t[e].delete})))}))}})}),(0,R.jsx)(Z.Z,{align:"center",padding:"checkbox",children:(0,R.jsx)(b.Z,{className:"table-checkbox",checked:F[e].delete,onChange:function(){return Q((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},e,(0,s.Z)((0,s.Z)({},t[e]),{},{delete:!t[e].delete,list:t[e].list||!t[e].delete,edit:t[e].edit||!t[e].delete,view:t[e].view||!t[e].delete,all:t[e].add&&!t[e].delete})))}))}})}),(0,R.jsx)(Z.Z,{align:"center",padding:"checkbox",children:(0,R.jsx)(b.Z,{className:"table-checkbox",checked:F[e].all,onChange:function(){return Q((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},e,(0,s.Z)((0,s.Z)({},t[e]),{},{all:!t[e].all,list:!t[e].all,view:!t[e].all,add:!t[e].all,edit:!t[e].all,delete:!t[e].all,fill:"Assessment"===F[e].name&&!t[e].all})))}))}})})]},e)}))})]})})})}),(0,R.jsxs)("div",{className:"form-btn flex-between add-members-btn",children:[(0,R.jsx)("button",{type:"reset",style:{marginTop:"20px"},className:"secondary-button mr-10",onClick:function(){return ne({defaultValues:q}),e("/roles")},children:"Cancel"}),(0,R.jsx)("button",{type:"submit",className:"primary-button",style:{marginTop:"20px"},disabled:K,children:"Save"})]})]})})]})})]})}},5473:function(e,t,r){r.d(t,{Z:function(){return S}});var n=r(4942),a=r(3366),i=r(7462),s=r(2791),l=r(8182),c=r(4419),o=r(2065),d=r(7278),u=r(1245),m=r(184),h=(0,u.Z)((0,m.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),p=(0,u.Z)((0,m.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),f=(0,u.Z)((0,m.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox"),x=r(9853),v=r(5513),Z=r(277),b=r(5878),g=r(1217);function j(e){return(0,g.Z)("MuiCheckbox",e)}var k=(0,b.Z)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary"]),N=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],w=(0,Z.ZP)(d.Z,{shouldForwardProp:function(e){return(0,Z.FO)(e)||"classes"===e},name:"MuiCheckbox",slot:"Root",overridesResolver:function(e,t){var r=e.ownerState;return[t.root,r.indeterminate&&t.indeterminate,"default"!==r.color&&t["color".concat((0,x.Z)(r.color))]]}})((function(e){var t,r=e.theme,a=e.ownerState;return(0,i.Z)({color:(r.vars||r).palette.text.secondary},!a.disableRipple&&{"&:hover":{backgroundColor:r.vars?"rgba(".concat("default"===a.color?r.vars.palette.action.activeChannel:r.vars.palette.primary.mainChannel," / ").concat(r.vars.palette.action.hoverOpacity,")"):(0,o.Fq)("default"===a.color?r.palette.action.active:r.palette[a.color].main,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==a.color&&(t={},(0,n.Z)(t,"&.".concat(k.checked,", &.").concat(k.indeterminate),{color:(r.vars||r).palette[a.color].main}),(0,n.Z)(t,"&.".concat(k.disabled),{color:(r.vars||r).palette.action.disabled}),t))})),y=(0,m.jsx)(p,{}),C=(0,m.jsx)(h,{}),M=(0,m.jsx)(f,{}),S=s.forwardRef((function(e,t){var r,n,o=(0,v.Z)({props:e,name:"MuiCheckbox"}),d=o.checkedIcon,u=void 0===d?y:d,h=o.color,p=void 0===h?"primary":h,f=o.icon,Z=void 0===f?C:f,b=o.indeterminate,g=void 0!==b&&b,k=o.indeterminateIcon,S=void 0===k?M:k,T=o.inputProps,E=o.size,z=void 0===E?"medium":E,A=o.className,L=(0,a.Z)(o,N),R=g?S:Z,O=g?S:u,P=(0,i.Z)({},o,{color:p,indeterminate:g,size:z}),I=function(e){var t=e.classes,r=e.indeterminate,n=e.color,a={root:["root",r&&"indeterminate","color".concat((0,x.Z)(n))]},s=(0,c.Z)(a,j,t);return(0,i.Z)({},t,s)}(P);return(0,m.jsx)(w,(0,i.Z)({type:"checkbox",inputProps:(0,i.Z)({"data-indeterminate":g},T),icon:s.cloneElement(R,{fontSize:null!=(r=R.props.fontSize)?r:z}),checkedIcon:s.cloneElement(O,{fontSize:null!=(n=O.props.fontSize)?n:z}),ownerState:P,ref:t,className:(0,l.Z)(I.root,A)},L,{classes:I}))}))}}]);
//# sourceMappingURL=129.48ffbf94.chunk.js.map