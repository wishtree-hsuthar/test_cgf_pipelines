"use strict";(self.webpackChunkpr74_cgf_hrdd_web_front=self.webpackChunkpr74_cgf_hrdd_web_front||[]).push([[7791],{32172:(e,s,a)=>{a.r(s),a.d(s,{default:()=>T});var t=a(97275),r=a(94294),n=a(72791),l=a(61134),i=a(57689),o=a(11087),d=a(51514),c=a(94677),m=a(46363),u=a(48086),p=a(27659),g=a(12820),h=a(14917),v=a(27954),f=a(7792),x=a(40600),y=a(29823),b=a(36571),j=a(76218),M=a(1260),N=a(28386),S=a(45736),C=a(59434),w=(a(74569),a(80184));const A={title:{required:"Enter the assessment title",minLength:"minimum 3 characters required"},assessmentType:{required:"Select the assessment type"},assignedMember:{required:"Select the member company"},assignedOperationMember:{required:"Select the operation member"},dueDate:{required:"Select the due date"},region:{required:"Select the region"},country:{required:"Select the country"},remarks:{minLength:"minimum 3 characters required",maxLength:"Reached max limit"}},T=()=>{(0,M.j)("Add Assessment");const e=(0,C.v9)((e=>{var s;return null===e||void 0===e||null===(s=e.user)||void 0===s?void 0:s.userObj})),{isMemberRepresentative:s,isOperationMember:a,memberId:T}=e,[O,D]=(0,n.useState)(""),[k,Z]=(0,n.useState)([]),[q,_]=(0,n.useState)([]),[E,H]=(0,n.useState)([]),[P,R]=(0,n.useState)([]),[Y,I]=(0,n.useState)([]),F=(0,i.s0)(),L=(0,n.useRef)(),[z,B]=(0,g.Z)({titleMessage:"",descriptionMessage:"",messageType:"success"}),{handleSubmit:K,control:U,reset:V,setValue:Q,trigger:G,watch:W}=(0,l.cI)({defaultValues:{title:"",assessmentType:"",assignedMember:"",assignedOperationMember:"",dueDate:"",remarks:"",questionnaireId:"",region:"",country:"",actionPlan:""}}),[J,X]=(0,n.useState)(null),[$,ee]=(0,n.useState)(""),se=[".jpg",".jpeg",".png",".doc",".txt",".pdf",".docx",".xlsx",".xls",".ppt",".pptx",".mp4",".mp3",".zip",".rar"];console.log("file in selection",J),console.log("action file in selection",null);const[ae,te]=(0,n.useState)(!1),[re,ne]=(0,n.useState)([]),[le,ie]=(0,n.useState)([]),[oe,de]=(0,n.useState)([]),[ce,me]=(0,n.useState)(!1),[ue,pe]=(0,n.useState)(!1);(0,n.useEffect)((()=>{let e=!0;const t=new AbortController;ge(t,e);(async()=>{try{const r=await c.H.get(s||a?"".concat(j.e7).concat(T):j.rm,{signal:t.signal});h.Y.info("Add assessments - Fetch member companies handler"),e&&Z(r.data.map((e=>({_id:e._id,name:e.companyName})))),H(r.data)}catch(r){h.Y.info("Add assessments - Fetch member companies handler catch error")}})();return(async()=>{h.Y.info("Add assessments - Fetch questionnaires handler");try{const s=await c.H.get(j.ZW+"/master",{signal:t.signal});e&&R(s.data.map((e=>e.title))),I(s.data.map((e=>({_id:e.uuid,name:e.title}))))}catch(s){h.Y.info("Add assessments - Fetch questionnaires handler catch error",s),(0,S.K)(s,B,L,F)}})(),()=>{e=!1,t.abort()}}),[]);const ge=async(e,s)=>{try{const s=await c.H.get(j.Up,{signal:e.signal});return ne(s.data),re}catch(o){var a,t;if("ERR_CANCELED"===(null===o||void 0===o?void 0:o.code))return;if(401==(null===o||void 0===o||null===(a=o.response)||void 0===a?void 0:a.status))s&&B({titleMessage:"Error",descriptionMessage:"Session Timeout: Please login again",messageType:"error"},(()=>L.current())),setTimeout((()=>{F("/login")}),3e3);else{if(403!==(null===o||void 0===o||null===(t=o.response)||void 0===t?void 0:t.status))return(e=>{var s,a;h.Y.info("Add Member - setErrorToaster handler"),B({titleMessage:"Error",descriptionMessage:null!==e&&void 0!==e&&null!==(s=e.response)&&void 0!==s&&null!==(a=s.data)&&void 0!==a&&a.message&&"string"===typeof e.response.data.message?e.response.data.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>L.current()))})(o),[];var r,n,l,i;s&&B({titleMessage:"Error",descriptionMessage:null!==o&&void 0!==o&&null!==(r=o.response)&&void 0!==r&&null!==(n=r.data)&&void 0!==n&&n.message?null===o||void 0===o||null===(l=o.response)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>L.current())),setTimeout((()=>{F("/home")}),3e3)}}},he=async(e,s)=>{h.Y.info("Add assessments - Fetch operation member handler");try{var a,t;const r=await c.H.get(s?j.C+e+"/master/internal":j.C+e+"/master");_(r.data.map((e=>({_id:e._id,name:e.name}))));let n=r.data.filter((e=>null===e||void 0===e?void 0:e.isMemberRepresentative));Q("assignedOperationMember",s?"":null!==(a=n[0])&&void 0!==a&&a._id?null===(t=n[0])||void 0===t?void 0:t._id:"")}catch(r){h.Y.info("Add assessments - Fetch operation member handler catch error")}},ve=e=>{e.preventDefault()};return(0,w.jsxs)("div",{className:"page-wrapper",children:[(0,w.jsx)(p.Z,{messageType:z.messageType,descriptionMessage:z.descriptionMessage,myRef:L,titleMessage:z.titleMessage}),(0,w.jsx)("div",{className:"breadcrumb-wrapper",children:(0,w.jsx)("div",{className:"container",children:(0,w.jsxs)("ul",{className:"breadcrumb",children:[(0,w.jsx)("li",{children:(0,w.jsx)(o.rU,{to:"/assessment-list",children:"Assessments"})}),(0,w.jsx)("li",{children:"Add Assessment"})]})})}),(0,w.jsx)("section",{children:ue?(0,w.jsx)(N.Z,{}):(0,w.jsx)("div",{className:"container",children:(0,w.jsxs)("form",{onSubmit:K((async e=>{h.Y.info("Add assessments - submitAssessments"),me(!0),console.log("file =",J);let s=new Date(e.dueDate).setDate(new Date(e.dueDate).getDate()+1),a=new FormData;a.append("actionPlan",e.actionPlan),a.append("actionPlanName",$),a.append("dueDate",new Date(new Date(s).setHours(0,0,0,0)).toISOString()),a.append("title",null===e||void 0===e?void 0:e.title),a.append("assessmentType",null===e||void 0===e?void 0:e.assessmentType),a.append("assignedMember",null===e||void 0===e?void 0:e.assignedMember),a.append("assignedOperationMember",null===e||void 0===e?void 0:e.assignedOperationMember),a.append("remarks",null===e||void 0===e?void 0:e.remarks),a.append("questionnaireId",null===e||void 0===e?void 0:e.questionnaireId),a.append("region",null===e||void 0===e?void 0:e.region),a.append("country",null===e||void 0===e?void 0:e.country),pe(!0);try{const e=await c.H.post(j.cj,a,{headers:{"Content-Type":"multipart/form-data"}});201===e.status&&(pe(!1),me(!1),V({title:"",assessmentType:"",assignedMember:"",assignedOperationMember:"",dueDate:"",remarks:"",questionnaireId:""}),B({titleMessage:"Success!",descriptionMessage:e.data.message,messageType:"success"},(()=>L.current())),setTimeout((()=>{F("/assessment-list")}),2e3))}catch(t){h.Y.info("Add assessments - submitAssessments catch error"),me(!1),(0,S.K)(t,B,L,F)}pe(!1)})),children:[(0,w.jsx)("div",{className:"form-header flex-between",children:(0,w.jsx)("h2",{className:"heading2",children:"Add Assessment"})}),(0,w.jsx)("div",{className:"card-wrapper",children:(0,w.jsxs)("div",{className:"card-blk flex-between",children:[(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{children:["Assessment Title ",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(u.Z,{name:"title",control:U,onBlur:e=>{var s;return Q("title",null===(s=e.target.value)||void 0===s?void 0:s.trim())},myHelper:A,placeholder:"Enter assessment title",rules:{required:"true",minLength:3,maxLength:50}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{children:["Assessment Type ",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(m.Z,{control:U,name:"assessmentType",placeholder:"Select assessment type",myHelper:A,rules:{required:!0},options:P,myOnChange:e=>{h.Y.info("Add assessments - handleChangeForAssessmentModule hanler");e.target.value;let s=Y.filter((s=>s.name===e.target.value));Q("questionnaireId",s[0]._id),Q("assessmentType",e.target.value),G("assessmentType")}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{children:["Member Company ",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(m.Z,{control:U,name:"assignedMember",placeholder:"Select member company",options:k,myHelper:A,myOnChange:async e=>{h.Y.info("Add assessments - HandleChangeForMemberCompany handler"),Q("assignedMember",e.target.value);let s=k.filter((s=>s._id===e.target.value));E.filter((s=>s._id===e.target.value));"The Consumer Goods Forum"===s[0].name?(te(!0),await he(e.target.value,!0)):(te(!1),await he(e.target.value,!1),G("assignedOperationMember")),G("assignedMember")},rules:{required:!0}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{children:["Operation Member ",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(m.Z,{control:U,isDisabled:!ae,name:"assignedOperationMember",options:q,placeholder:"Select operation member ",myHelper:A,rules:{required:!0}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{htmlFor:"region",children:["Region",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(m.Z,{control:U,myOnChange:async e=>{h.Y.info("Add member - onRegionChangeHandlerAddMember handler"),Q("country",""),Q("region",e.target.value),G("region");const s=await(async e=>{h.Y.info("Add member - getCountriesAddMember handler");try{return await c.H.get(j.rF+"/".concat(e))}catch(t){var s,a;if("ERR_CANCELED"===(null===t||void 0===t?void 0:t.code))return;return h.Y.info("Add member - getCountriesAddMember handler catch error - ".concat(null===t||void 0===t||null===(s=t.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message," ")),[]}})(W("region")),a=((t=s.data).forEach(((e,s)=>t[s]=e.hasOwnProperty("_id")?e.name:e)),t);var t;ie([...a])},name:"region",rules:{required:!0},placeholder:"Select region",myHelper:A,options:re})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{htmlFor:"country",children:["Country",(0,w.jsx)("span",{className:"mandatory",children:" *"})]}),(0,w.jsx)(m.Z,{control:U,name:"country",rules:{required:!0},myOnChange:async e=>{h.Y.info("Add Member - onCountryChangeHandlerAddMember handler"),Q("country",e.target.value);const s=await c.H.get(j.PO+"/".concat(e.target.value));de(s.data)},placeholder:"Select country",myHelper:A,options:le})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{children:["Due Date ",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(l.Qr,{name:"dueDate",control:U,rules:{required:!0},render:e=>{let{field:s,fieldState:{error:a}}=e;return(0,w.jsx)(b._,{dateAdapter:f.y,children:(0,w.jsx)(d.M,{disablePast:!0,className:"datepicker-blk",components:{OpenPickerIcon:v.Z},value:O,onChange:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";D(e),Q("dueDate",null===e||void 0===e?void 0:e.toISOString()),G("dueDate")},renderInput:e=>(0,w.jsx)(t.Z,{autoComplete:"off",...e,className:" input-field ".concat(a&&"input-error"),onKeyDown:ve,placeholder:"MM/DD/YYYY",error:!0,helperText:a?A.dueDate[a.type]:" "})})})}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsx)("label",{children:"Remarks/Comments"}),(0,w.jsx)(l.Qr,{name:"remarks",control:U,rules:{minLength:3,maxLength:250},render:e=>{let{field:s,fieldState:{error:a}}=e;return(0,w.jsx)(t.Z,{multiline:!0,...s,onBlur:e=>{var s;return Q("remarks",null===(s=e.target.value)||void 0===s?void 0:s.trim())},inputProps:{maxLength:250},className:"input-textarea ".concat(a&&"input-textarea-error"),id:"outlined-basic",placeholder:"Enter remarks/comments",helperText:a?A.remarks[a.type]:" ",variant:"outlined"})}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsx)("label",{children:"Action Plan"}),(0,w.jsxs)("div",{className:"upload-file-wrap",children:[(0,w.jsx)(r.Z,{variant:"contained",component:"label",className:"upload-file-btn",children:(0,w.jsxs)("div",{className:"upload-file-blk",children:[(0,w.jsx)("input",{type:"file",hidden:!0,accept:".jpg, .jpeg, .png, .doc, .txt, .pdf, .docx, .xlsx, .xls, .ppt, .pptx, .mp4, .mp3, .zip, .rar",name:"files[]",onChange:e=>{const s=e.target.files[0];if(s){const a=".".concat(s.name.split(".").pop());if(!se.includes(a.toLowerCase()))return void alert("Invalid file type. Please select a valid file.");if(s.size>10485760)return void alert("File size exceeds the limit of 10 MB. Please select a smaller file.");Q("actionPlan",e.target.files[0]),console.log("inside if"),ee(s.name);(new FileReader).onload=e=>{var s;X(null===e||void 0===e||null===(s=e.target)||void 0===s?void 0:s.result)}}}}),(0,w.jsx)("span",{className:"upload-icon",children:(0,w.jsx)(x.Z,{})}),(0,w.jsxs)("span",{className:"file-upload-txt",children:["Click here to choose files (max file size"," ","".concat("10"," MB"),")"]})]})}),(0,w.jsx)("p",{style:{color:"#f7a823",fontFamily:"ProximaNova-Semibold, serif, sans-serif",margin:"10px 0px"},children:"Uploading large files may take some time"}),$,(0,w.jsxs)("span",{className:"file-close-icon",style:{display:$.length>1?"inline-block":"none",cursor:"pointer"},onClick:()=>{X(null),ee("")},children:[" ",(0,w.jsx)(y.Z,{})]})]})]})}),(0,w.jsxs)("div",{className:"form-btn flex-between add-members-btn",children:[(0,w.jsx)("button",{type:"reset",onClick:()=>F("/assessment-list"),className:"secondary-button mr-10",children:"Cancel"}),(0,w.jsx)("button",{type:"submit",className:"primary-button add-button",disabled:ce,children:"Save"})]})]})})]})})})]})}},48086:(e,s,a)=>{a.d(s,{Z:()=>l});var t=a(97275),r=(a(72791),a(61134)),n=a(80184);const l=e=>{let{control:s,name:a,myHelper:l,placeholder:i,myOnChange:o,rules:d,onBlur:c,multiline:m,isDisabled:u}=e;const{field:{onChange:p,value:g,ref:h},fieldState:{error:v}}=(0,r.bc)({name:a,control:s,rules:d,defaultValue:""});return(0,n.jsx)(t.Z,{disabled:u,className:"input-field ".concat(v&&"input-error"),placeholder:i,onChange:o||p,onBlur:c,value:g,inputRef:h,inputProps:{maxLength:(null===d||void 0===d?void 0:d.maxLength)&&d.maxLength},helperText:v?l&&l[a]&&l[a][v.type]?l[a][v.type]:"Invalid Input":" ",variant:"outlined"})}},27659:(e,s,a)=>{a.d(s,{Z:()=>o});var t=a(92131),r=a(5130),n=a(72791),l=a(29655),i=(a(5462),a(80184));const o=function(e){let{titleMessage:s,descriptionMessage:a,messageType:o,myRef:d,key:c}=e;const m=()=>{(0,l.Am)(u,{position:"bottom-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,toastId:"toastId"})},u=()=>(0,i.jsxs)("div",{className:"toaster-blk flex-start ".concat("success"===o&&"toaster-blk-success"),children:[(0,i.jsx)("div",{className:"toaster-left ".concat("success"===o&&"toaster-left-success"),children:(0,i.jsxs)("div",{className:"toaster-icon",children:["success"===o&&(0,i.jsx)(t.Z,{}),"error"===o&&(0,i.jsx)(r.Z,{})]})}),(0,i.jsx)("div",{className:"toaster-right",children:(0,i.jsx)("p",{children:a})})]});return(0,n.useEffect)((()=>{d.current=m}),[m,d]),(0,i.jsxs)("div",{className:"toaster-sect",children:[(0,i.jsx)("button",{style:{display:"none"},children:"Show Toast !"}),(0,i.jsx)(l.Ix,{className:"toaster-wrap ".concat("success"===o&&"toaster-wrap-success"," ")})]})}},45736:(e,s,a)=>{a.d(s,{K:()=>t});const t=async function(e,s,a,t,r){var n,l;let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if("ERR_CANCELED"===(null===e||void 0===e?void 0:e.code))return null;if(401==(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.status))s({titleMessage:"Oops!",descriptionMessage:"Session Timeout: Please login again!",messageType:"error"},(()=>a.current())),setTimeout((()=>{t("/login")}),3e3);else if(403===(null===e||void 0===e||null===(l=e.response)||void 0===l?void 0:l.status)){var o,d,c,m;s({titleMessage:"Oops!",descriptionMessage:null!==e&&void 0!==e&&null!==(o=e.response)&&void 0!==o&&null!==(d=o.data)&&void 0!==d&&d.message?null===e||void 0===e||null===(c=e.response)||void 0===c||null===(m=c.data)||void 0===m?void 0:m.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>a.current())),setTimeout((()=>{t("/home")}),3e3)}else{var u,p,g,h;s({titleMessage:"Oops!",descriptionMessage:null!==e&&void 0!==e&&null!==(u=e.response)&&void 0!==u&&null!==(p=u.data)&&void 0!==p&&p.message?null===e||void 0===e||null===(g=e.response)||void 0===g||null===(h=g.data)||void 0===h?void 0:h.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>a.current())),r&&setTimeout((()=>{t(r,{state:i})}),3e3)}}},12820:(e,s,a)=>{a.d(s,{Z:()=>r});var t=a(72791);const r=e=>{const[s,a]=(0,t.useState)(e),r=(0,t.useRef)([]);(0,t.useEffect)((()=>{r.current.forEach((e=>e(s))),r.current=[]}),[s]);return[s,(e,s)=>{a(e),s&&"function"===typeof s&&r.current.push(s)}]}},1260:(e,s,a)=>{a.d(s,{j:()=>r});var t=a(72791);const r=e=>((0,t.useEffect)((()=>{document.title="HRDD System - ".concat(e)}),[e]),null)},40600:(e,s,a)=>{var t=a(64836);s.Z=void 0;var r=t(a(45649)),n=a(80184),l=(0,r.default)((0,n.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM19 18H6c-2.21 0-4-1.79-4-4 0-2.05 1.53-3.76 3.56-3.97l1.07-.11.5-.95C8.08 7.14 9.94 6 12 6c2.62 0 4.88 1.86 5.39 4.43l.3 1.5 1.53.11c1.56.1 2.78 1.41 2.78 2.96 0 1.65-1.35 3-3 3zM8 13h2.55v3h2.9v-3H16l-4-4z"}),"CloudUploadOutlined");s.Z=l}}]);
//# sourceMappingURL=7791.3136b7eb.chunk.js.map