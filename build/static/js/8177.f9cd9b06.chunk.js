"use strict";(self.webpackChunkpr74_cgf_hrdd_web_front=self.webpackChunkpr74_cgf_hrdd_web_front||[]).push([[8177],{8617:function(e,n,i){i.r(n),i.d(n,{default:function(){return V}});var t=i(4165),s=i(1413),r=i(5861),o=i(885),a=i(2791),l=i(6015),u=i(4293),c=i(5814),d=i(166),v=i(8588),p=i(1346),h=i(9407),m=i(7265),f=i(2900),x=i(6321),g=i(5473),b=i(8723),j=i(4917),w=i(7792),y=i(6571),Z=i(2104),N=i(7954),q=i(184),k={PaperProps:{style:{maxHeight:168}},anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"}},T=function(e){var n=e.question,i=n.questionTitle;j.Y.debug("title preview question",i),j.Y.debug("title preview question",n.questionTitle);var t="singleTextbox"===n.inputType?(0,q.jsx)(v.Z,{placeholder:"Enter text here",className:"input-field",InputProps:{readOnly:!0}}):"textarea"===n.inputType?(0,q.jsx)(v.Z,{multiline:!0,InputProps:{readOnly:!0},className:"input-textarea",placeholder:"Enter text here",variant:"outlined"}):"dropdown"===n.inputType?(0,q.jsx)("div",{className:"form-group",children:(0,q.jsx)("div",{className:"select-field",children:(0,q.jsx)(p.Z,{IconComponent:function(e){return(0,q.jsx)(Z.Z,(0,s.Z)({},e))},value:n.questionTitle,MenuProps:k,renderValue:function(){return(0,q.jsx)("div",{className:"select-placeholder",children:"Choose dropdown value"})},children:n.options.map((function(e){return(0,q.jsx)(h.Z,{value:e,disabled:!0,children:e},e)}))})})}):"radioGroup"===n.inputType?(0,q.jsx)("div",{className:"radio-btn-field radio-btn-half-blk",children:(0,q.jsx)(m.Z,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"Active",name:"radio-buttons-group",className:"radio-btn radio-btn-vertical",children:n.options.map((function(e){return(0,q.jsx)(f.Z,{value:e,control:(0,q.jsx)(x.Z,{disabled:!0}),label:e})}))})}):"checkbox"===n.inputType?(0,q.jsx)("div",{className:"checkbox-with-labelblk checkbox-btn-half-blk",children:n.options.map((function(e){return(0,q.jsx)(f.Z,{className:"checkbox-with-label checkbox-flex",control:(0,q.jsx)(g.Z,{disabled:!0}),label:e})}))}):"date"===n.inputType?(0,q.jsx)(y._,{dateAdapter:w.y,children:(0,q.jsx)(b.M,{disabled:!0,value:null,className:"datepicker-blk",components:{OpenPickerIcon:N.Z},onChange:function(){},renderInput:function(e){return(0,q.jsx)(v.Z,(0,s.Z)((0,s.Z)({},e),{},{helperText:" "}))}})}):"";return(0,q.jsx)("div",{className:"preview-que-blk",children:(0,q.jsxs)("div",{className:"form-group",children:[(0,q.jsx)("label",{htmlFor:"questionTitle",children:(0,q.jsxs)("div",{className:"preview-sect-txt",children:[i,(null===n||void 0===n?void 0:n.isRequired)&&(0,q.jsx)("span",{className:"mandatory",children:" *"})]})}),(0,q.jsx)("div",{className:"que-half-sect",children:t})]})})},M=i(3989);var P=function(e){var n=e.questionnaire,i=e.section,t=e.sectionIndex;return(0,a.useEffect)((function(){j.Y.debug("section:- ",i)}),[]),(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)("div",{className:"preview-sect-ttl-wrap",children:[(0,q.jsx)("div",{className:"preview-sect-card-ttl-blk",children:(0,q.jsx)("h2",{className:"subheading",children:null===i||void 0===i?void 0:i.sectionTitle})}),(0,q.jsx)("div",{className:"preview-sect-txt",children:null===i||void 0===i?void 0:i.description})]}),(0,q.jsx)("div",{className:"preview-card-wrapper",children:(0,q.jsx)("div",{className:"preview-que-wrap que-preview",children:"form"===(null===i||void 0===i?void 0:i.layout)?i.questions.map((function(e){return(0,q.jsx)(T,{question:e},null===e||void 0===e?void 0:e.uuid)})):(0,q.jsx)(M.Z,{questionnaire:n,sectionIndex:t,isPreview:!0})})})]})},D=i(7689),C=i(1087),S=i(4677),E=i(6218),Y=i(1260),O=i(9434),Q=i(2898),I=i(2820),_=i(7659),A=i(8460),H=i(1300),R=i(4569),B=i.n(R),z=i(7806),U=i(8386);function L(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var V=function(e){var n,i,v,p,h,m,f,x,g,b=(0,a.useState)(0),w=(0,o.Z)(b,2),y=w[0],Z=w[1];(0,Y.j)("Preview Questionnaire");var N=(0,a.useState)(!1),k=(0,o.Z)(N,2),T=k[0],M=k[1],R=(0,a.useState)(!1),V=(0,o.Z)(R,2),F=V[0],W=V[1],K=(0,I.Z)({titleMessage:"",descriptionMessage:"",messageType:"success"}),G=(0,o.Z)(K,2),J=G[0],X=G[1],$=(0,a.useRef)(),ee=(0,D.UO)(),ne=(0,D.s0)();j.Y.debug("params in questionnaire",ee["*"].includes("version")),j.Y.debug("props in questionnaire",e);var ie=(0,a.useState)({}),te=(0,o.Z)(ie,2),se=te[0],re=te[1],oe=(0,O.v9)((function(e){var n;return null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.privilege})),ae=(0,O.v9)((function(e){var n;return null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.userObj})),le="Super Admin"===(null===oe||void 0===oe?void 0:oe.name),ue=("Super Admin"===(null===ae||void 0===ae||null===(n=ae.roleId)||void 0===n?void 0:n.name)?[]:Object.values(null===oe||void 0===oe?void 0:oe.privileges)).filter((function(e){var n;return"Questionnaire"===(null===e||void 0===e||null===(n=e.moduleId)||void 0===n?void 0:n.name)})).map((function(e){return{questionnaire:{list:null===e||void 0===e?void 0:e.list,view:null===e||void 0===e?void 0:e.view,edit:null===e||void 0===e?void 0:e.edit,delete:null===e||void 0===e?void 0:e.delete,add:null===e||void 0===e?void 0:e.add}}}));(0,a.useEffect)((function(){var e=!0,n=new AbortController,i=function(){var i=(0,r.Z)((0,t.Z)().mark((function i(){var r;return(0,t.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,M(!0),i.next=4,S.H.get("".concat(E.ZW,"/").concat(ee.id),{signal:n.signal});case 4:r=i.sent,j.Y.debug("response from fetch questionnaire",r),e&&re((0,s.Z)({},r.data)),M(!1),i.next=17;break;case 10:if(i.prev=10,i.t0=i.catch(0),"ERR_CANCELED"!==(null===i.t0||void 0===i.t0?void 0:i.t0.code)){i.next=14;break}return i.abrupt("return");case 14:M(!1),he(i.t0),j.Y.debug("error from fetch questionnaire",i.t0);case 17:case"end":return i.stop()}}),i,null,[[0,10]])})));return function(){return i.apply(this,arguments)}}();return i(),function(){e=!1,n.abort()}}),[]);var ce=(0,a.useState)(!1),de=(0,o.Z)(ce,2),ve=de[0],pe=de[1];j.Y.debug("edit access = ",(null===(i=ue[0])||void 0===i||null===(v=i.questionnaire)||void 0===v?void 0:v.edit)&&ee["*"].includes("edit"));var he=function(e){var n,i,t;if("ERR_CANCELED"!==(null===e||void 0===e?void 0:e.code))if(401==(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.status))X({titleMessage:"Error",descriptionMessage:"Session Timeout: Please login again",messageType:"error"},(function(){return $.current()})),setTimeout((function(){ne("/login")}),3e3);else if(403===(null===e||void 0===e||null===(i=e.response)||void 0===i?void 0:i.status)){var s,r,o,a;X({titleMessage:"Error",descriptionMessage:null!==e&&void 0!==e&&null!==(s=e.response)&&void 0!==s&&null!==(r=s.data)&&void 0!==r&&r.message?null===e||void 0===e||null===(o=e.response)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(function(){return $.current()})),setTimeout((function(){ne("/home")}),3e3)}else if(400===(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status)&&"Invalid questionnaire!"===e.response.data.message){var l,u,c,d;X({titleMessage:"Error",descriptionMessage:null!==e&&void 0!==e&&null!==(l=e.response)&&void 0!==l&&null!==(u=l.data)&&void 0!==u&&u.message?null===e||void 0===e||null===(c=e.response)||void 0===c||null===(d=c.data)||void 0===d?void 0:d.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(function(){return $.current()})),setTimeout((function(){ne("/questionnaires")}),3e3)}else{var v,p;X({titleMessage:"Error",descriptionMessage:null!==e&&void 0!==e&&null!==(v=e.response)&&void 0!==v&&null!==(p=v.data)&&void 0!==p&&p.message&&"string"===typeof e.response.data.message?e.response.data.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(function(){return $.current()}))}},me=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(n){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j.Y.debug("Questionnaire",se),e.next=4,B().delete(E.ZW+"/".concat(null===se||void 0===se?void 0:se.uuid),{data:{deletionType:n}});case 4:return X({titleMessage:"Success",descriptionMessage:"".concat("inactive"===n?"Questionnaire inactivated successfully!":"Questionnaire deleted successfully!"),messageType:"success"},(function(){return $.current()})),e.abrupt("return",setTimeout((function(){return ne("/questionnaires",{state:0})}),3e3));case 8:e.prev=8,e.t0=e.catch(0),he(e.t0);case 11:return e.prev=11,W(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(n){return e.apply(this,arguments)}}(),fe=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(){var n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B().delete(E.uf+"/".concat(null===se||void 0===se?void 0:se.uuid));case 3:return n=e.sent,X({titleMessage:"Success",descriptionMessage:n.data.message,messageType:"success"},(function(){return $.current()})),e.abrupt("return",setTimeout((function(){return ne("/questionnaires",{state:1})}),3e3));case 8:e.prev=8,e.t0=e.catch(0),he(e.t0);case 11:return e.prev=11,W(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se&&null!==se&&void 0!==se&&se.isPublished?me("delete"):fe();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,q.jsxs)("div",{className:"page-wrapper",onClick:function(){return ve&&pe(!1)},children:[(0,q.jsx)(H.Z,{title:(0,q.jsxs)("p",{children:[" ","Delete Questionnaire"," ",se&&!(null!==se&&void 0!==se&&se.isPublished)&&"Draft"]}),info1:(0,q.jsx)("p",{children:se&&null!==se&&void 0!==se&&se.isPublished?"Deleting the questionnaire will also delete the related assessments. we recommend you make the questionnaire inactive":"You can not access this draft version of questionnaire any more once delete."}),info2:(0,q.jsxs)("p",{children:["Are you sure you want to delete the questionnaire"," ",se&&!(null!==se&&void 0!==se&&se.isPublished)&&"draft","?"]}),primaryButtonText:se&&null!==se&&void 0!==se&&se.isPublished?"Delete Anyway":"Delete",secondaryButtonText:se&&null!==se&&void 0!==se&&se.isPublished?"Inactive":"Cancel",onPrimaryModalButtonClickHandler:xe,onSecondaryModalButtonClickHandler:function(){se&&null!==se&&void 0!==se&&se.isPublished?me("inactive"):W(!1)},openModal:F,setOpenModal:W}),(0,q.jsx)(_.Z,{myRef:$,titleMessage:J.titleMessage,descriptionMessage:J.descriptionMessage,messageType:J.messageType}),(0,q.jsx)("div",{className:"breadcrumb-wrapper",children:(0,q.jsx)("div",{className:"container",children:(0,q.jsxs)("ul",{className:"breadcrumb",children:[(0,q.jsx)("li",{children:(0,q.jsxs)(C.rU,{to:"/questionnaires",style:{cursor:"pointer"},state:null!==se&&void 0!==se&&se.isPublished?0:1,children:["Questionnaire  ",null!==se&&void 0!==se&&se.isPublished?"(Published)":"(Drafted)"]})}),ee["*"].includes("version")&&(0,q.jsx)("li",{children:(0,q.jsx)(C.rU,{to:"/questionnaire-version-history/".concat(ee.id),style:{cursor:"pointer"},children:"Questionnaire History"})}),ee["*"].includes("version")?(0,q.jsx)("li",{children:"Preview Questionnaire History"}):(0,q.jsx)("li",{children:"Preview Questionnaire "})]})})}),(0,q.jsx)("section",{children:(0,q.jsxs)("div",{className:"container",children:[(0,q.jsxs)("div",{className:"form-header",children:[(0,q.jsxs)("div",{className:"flex-between preview-que-ttl-blk",children:[(0,q.jsx)("h2",{className:"heading2",children:null===se||void 0===se?void 0:se.title}),(0,q.jsxs)("span",{className:"form-header-right-txt",onClick:function(){pe(!ve)},children:[(0,q.jsx)("span",{className:"crud-operation ".concat(ve&&"crud-operation-active"),children:(0,q.jsx)(Q.Z,{})}),(0,q.jsx)("div",{className:"crud-toggle-wrap que-crud-toggle-wrap",style:{display:ve?"block":"none"},children:(0,q.jsxs)("ul",{className:"crud-toggle-list",children:[(0,q.jsx)("li",{onClick:function(){return(0,z.j)("Questionnaire",X,ee.id,$,E.KW,ne)},children:"Export to Excel"}),!ee["*"].includes("version")&&!(null!==se&&void 0!==se&&se.isDraft)&&(0,q.jsx)("li",{onClick:function(){return ne("/questionnaire-version-history/".concat(ee.id))},children:"Version History"}),(!0===le||(null===(p=ue[0])||void 0===p||null===(h=p.questionnaire)||void 0===h?void 0:h.edit))&&!ee["*"].includes("version")&&((null===se||void 0===se?void 0:se.isDraft)||(null===se||void 0===se?void 0:se.isPublished))&&(0,q.jsx)("li",{onClick:function(){return ne("/questionnaires/edit-questionnaire/".concat(ee.id))},children:"Edit Questionnaire"}),(!0===le||(null===(m=ue[0])||void 0===m||null===(f=m.questionnaire)||void 0===f?void 0:f.delete))&&(0,q.jsx)("li",{onClick:function(){return W(!0)},children:"Delete Questionnaire"})]})})]})]}),(0,q.jsx)("div",{className:"excel-short-name",children:(0,q.jsx)("p",{children:null===se||void 0===se?void 0:se.sheetName})})]}),T?(0,q.jsx)(U.Z,{}):(0,q.jsxs)("div",{className:"section-form-sect",children:[(0,q.jsx)("div",{className:"section-tab-blk flex-between preview-tab-blk",children:(0,q.jsx)("div",{className:"section-tab-leftblk",children:(0,q.jsx)(l.Z,{sx:{borderBottom:1,borderColor:"divider"},className:"tabs-sect que-tab-sect",children:(0,q.jsx)(u.Z,{value:y,onChange:function(e,n){Z(n)},"aria-label":"basic tabs example",variant:"scrollable",scrollButtons:"auto",children:null===se||void 0===se||null===(x=se.sections)||void 0===x?void 0:x.map((function(e,n,i){var t;return(0,q.jsx)(c.Z,{title:e.sectionTitle,placement:"bottom-start",children:(0,q.jsx)(d.Z,(0,s.Z)({className:"section-tab-item",label:"section ".concat(n+1)},L(n)))},null!==(t=null===e||void 0===e?void 0:e.uuid)&&void 0!==t?t:i)}))})})})}),(0,q.jsx)("div",{className:"preview-tab-data",children:null===se||void 0===se||null===(g=se.sections)||void 0===g?void 0:g.map((function(e,n){var i;return(0,q.jsx)(A.x,{value:y,index:n,children:(0,q.jsx)(P,{questionnaire:se,section:e,sectionIndex:n})},null!==(i=null===e||void 0===e?void 0:e.uuid)&&void 0!==i?i:n)}))})]})]})})]})}},7806:function(e,n,i){i.d(n,{j:function(){return l}});var t=i(4165),s=i(5861),r=i(4677),o=i(4917),a=i(5736),l=function(){var e=(0,s.Z)((0,t.Z)().mark((function e(n,i,s,l,u,c){var d,v,p,h,m,f,x,g,b,j;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.Y.debug("navigate = ",c),e.prev=1,e.next=4,r.H.get(s?u+s+"/download":u,{responseType:"blob"});case 4:d=e.sent,o.Y.debug("resposne from ".concat(n,"  assessment "),d),v=window.URL.createObjectURL(new Blob([d.data])),(p=document.createElement("a")).href=v,h=(new Date).getDate()<10?"0"+(new Date).getDate().toString():(new Date).getDate().toString(),m=(new Date).getMonth()<10?"0"+((new Date).getMonth()+1).toString():(new Date).getMonth().toString(),f=(new Date).getFullYear().toString(),x=(new Date).getHours(),g=(new Date).getMinutes(),b=(new Date).getSeconds(),j=m+h+f+"_"+x+g+b,p.setAttribute("download","".concat(n," - ").concat(j,".xlsx")),document.body.appendChild(p),p.click(),200==d.status&&i({titleMessage:"Success!",descriptionMessage:"Downloaded Successfully!",messageType:"success"},(function(){return l.current()})),e.next=27;break;case 22:return e.prev=22,e.t0=e.catch(1),o.Y.debug("Error from ".concat(n,"  Assessment"),e.t0),(0,a.K)(e.t0,i,l,c),e.abrupt("return",e.t0);case 27:case"end":return e.stop()}}),e,null,[[1,22]])})));return function(n,i,t,s,r,o){return e.apply(this,arguments)}}()},2898:function(e,n,i){var t=i(4836);n.Z=void 0;var s=t(i(5649)),r=i(184),o=(0,s.default)((0,r.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert");n.Z=o}}]);
//# sourceMappingURL=8177.f9cd9b06.chunk.js.map