"use strict";(self.webpackChunkpr74_cgf_hrdd_web_front=self.webpackChunkpr74_cgf_hrdd_web_front||[]).push([[2172],{32172:(e,s,a)=>{a.r(s),a.d(s,{default:()=>T});var n=a(97275),r=a(94294),t=a(72791),l=a(61134),i=a(57689),o=a(11087),d=a(51514),c=a(94677),m=a(46363),u=a(48086),p=a(27659),g=a(12820),h=a(14917),v=a(27954),f=a(7792),x=a(40600),y=a(29823),b=a(36571),j=a(76218),M=a(1260),N=a(28386),S=a(45736),C=a(59434),w=(a(74569),a(80184));const A={title:{required:"Enter the assessment title",minLength:"minimum 3 characters required"},assessmentType:{required:"Select the assessment type"},assignedMember:{required:"Select the member company"},assignedOperationMember:{required:"Select the operation member"},dueDate:{required:"Select the due date"},region:{required:"Select the region"},country:{required:"Select the country"},remarks:{minLength:"minimum 3 characters required",maxLength:"Reached max limit"}},T=()=>{(0,M.j)("Add Assessment");const e=(0,C.v9)((e=>{var s;return null===e||void 0===e||null===(s=e.user)||void 0===s?void 0:s.userObj})),{isMemberRepresentative:s,isOperationMember:a,memberId:T}=e,[D,O]=(0,t.useState)(""),[k,q]=(0,t.useState)([]),[P,_]=(0,t.useState)([]),[H,Z]=(0,t.useState)([]),[E,Y]=(0,t.useState)([]),[F,R]=(0,t.useState)([]),L=(0,i.s0)(),I=(0,t.useRef)(),[z,B]=(0,g.Z)({titleMessage:"",descriptionMessage:"",messageType:"success"}),{handleSubmit:K,control:U,reset:V,setValue:Q,trigger:G,watch:W}=(0,l.cI)({defaultValues:{title:"",assessmentType:"",assignedMember:"",assignedOperationMember:"",dueDate:"",remarks:"",questionnaireId:"",region:"",country:"",actionPlan:""}}),[J,X]=(0,t.useState)(null),[$,ee]=(0,t.useState)(""),se=[".doc",".pdf",".docx",".xlsx",".xls"];let ae=new FormData;console.log("file in selection",J),console.log("action file in selection",null);const[ne,re]=(0,t.useState)(!1),[te,le]=(0,t.useState)([]),[ie,oe]=(0,t.useState)([]),[de,ce]=(0,t.useState)([]),[me,ue]=(0,t.useState)(!1),[pe,ge]=(0,t.useState)(!1);(0,t.useEffect)((()=>{let e=!0;const n=new AbortController;he(n,e);(async()=>{try{const r=await c.H.get(s||a?"".concat(j.e7).concat(T):j.rm,{signal:n.signal});h.Y.info("Add assessments - Fetch member companies handler"),e&&q(r.data.map((e=>({_id:e._id,name:e.companyName})))),Z(r.data)}catch(r){h.Y.info("Add assessments - Fetch member companies handler catch error")}})();return(async()=>{h.Y.info("Add assessments - Fetch questionnaires handler");try{const s=await c.H.get(j.ZW+"/master",{signal:n.signal});e&&Y(s.data.map((e=>e.title))),R(s.data.map((e=>({_id:e.uuid,name:e.title}))))}catch(s){h.Y.info("Add assessments - Fetch questionnaires handler catch error",s),(0,S.K)(s,B,I,L)}})(),()=>{e=!1,n.abort()}}),[]);const he=async(e,s)=>{try{const s=await c.H.get(j.Up,{signal:e.signal});return le(s.data),te}catch(o){var a,n;if("ERR_CANCELED"===(null===o||void 0===o?void 0:o.code))return;if(401==(null===o||void 0===o||null===(a=o.response)||void 0===a?void 0:a.status))s&&B({titleMessage:"Error",descriptionMessage:"Session Timeout: Please login again",messageType:"error"},(()=>I.current())),setTimeout((()=>{L("/login")}),3e3);else{if(403!==(null===o||void 0===o||null===(n=o.response)||void 0===n?void 0:n.status))return(e=>{var s,a;h.Y.info("Add Member - setErrorToaster handler"),B({titleMessage:"Error",descriptionMessage:null!==e&&void 0!==e&&null!==(s=e.response)&&void 0!==s&&null!==(a=s.data)&&void 0!==a&&a.message&&"string"===typeof e.response.data.message?e.response.data.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>I.current()))})(o),[];var r,t,l,i;s&&B({titleMessage:"Error",descriptionMessage:null!==o&&void 0!==o&&null!==(r=o.response)&&void 0!==r&&null!==(t=r.data)&&void 0!==t&&t.message?null===o||void 0===o||null===(l=o.response)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>I.current())),setTimeout((()=>{L("/home")}),3e3)}}},ve=async(e,s)=>{h.Y.info("Add assessments - Fetch operation member handler");try{var a,n;const r=await c.H.get(s?j.C+e+"/master/internal":j.C+e+"/master");_(r.data.map((e=>({_id:e._id,name:e.name}))));let t=r.data.filter((e=>null===e||void 0===e?void 0:e.isMemberRepresentative));Q("assignedOperationMember",s?"":null!==(a=t[0])&&void 0!==a&&a._id?null===(n=t[0])||void 0===n?void 0:n._id:"")}catch(r){h.Y.info("Add assessments - Fetch operation member handler catch error")}},fe=e=>{e.preventDefault()};return(0,w.jsxs)("div",{className:"page-wrapper",children:[(0,w.jsx)(p.Z,{messageType:z.messageType,descriptionMessage:z.descriptionMessage,myRef:I,titleMessage:z.titleMessage}),(0,w.jsx)("div",{className:"breadcrumb-wrapper",children:(0,w.jsx)("div",{className:"container",children:(0,w.jsxs)("ul",{className:"breadcrumb",children:[(0,w.jsx)("li",{children:(0,w.jsx)(o.rU,{to:"/assessment-list",children:"Assessments"})}),(0,w.jsx)("li",{children:"Add Assessment"})]})})}),(0,w.jsx)("section",{children:pe?(0,w.jsx)(N.Z,{}):(0,w.jsx)("div",{className:"container",children:(0,w.jsxs)("form",{onSubmit:K((async e=>{h.Y.info("Add assessments - submitAssessments"),ue(!0),console.log("file =",J);let s=new Date(e.dueDate).setDate(new Date(e.dueDate).getDate()+1);ae.append("actionPlan",e.actionPlan),ae.append("actionPlanName",$),ae.append("dueDate",new Date(new Date(s).setHours(0,0,0,0)).toISOString()),ae.append("title",null===e||void 0===e?void 0:e.title),ae.append("assessmentType",null===e||void 0===e?void 0:e.assessmentType),ae.append("assignedMember",null===e||void 0===e?void 0:e.assignedMember),ae.append("assignedOperationMember",null===e||void 0===e?void 0:e.assignedOperationMember),ae.append("remarks",null===e||void 0===e?void 0:e.remarks),ae.append("questionnaireId",null===e||void 0===e?void 0:e.questionnaireId),ae.append("region",null===e||void 0===e?void 0:e.region),ae.append("country",null===e||void 0===e?void 0:e.country),ge(!0);try{const e=await c.H.post(j.cj,ae,{headers:{"Content-Type":"multipart/form-data"}});201===e.status&&(ge(!1),ue(!1),V({title:"",assessmentType:"",assignedMember:"",assignedOperationMember:"",dueDate:"",remarks:"",questionnaireId:""}),B({titleMessage:"Success!",descriptionMessage:e.data.message,messageType:"success"},(()=>I.current())),setTimeout((()=>{L("/assessment-list")}),2e3))}catch(a){h.Y.info("Add assessments - submitAssessments catch error"),ue(!1),(0,S.K)(a,B,I,L)}ge(!1)})),children:[(0,w.jsx)("div",{className:"form-header flex-between",children:(0,w.jsx)("h2",{className:"heading2",children:"Add Assessment"})}),(0,w.jsx)("div",{className:"card-wrapper",children:(0,w.jsxs)("div",{className:"card-blk flex-between",children:[(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{children:["Assessment Title ",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(u.Z,{name:"title",control:U,onBlur:e=>{var s;return Q("title",null===(s=e.target.value)||void 0===s?void 0:s.trim())},myHelper:A,placeholder:"Enter assessment title",rules:{required:"true",minLength:3,maxLength:50}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{children:["Assessment Type ",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(m.Z,{control:U,name:"assessmentType",placeholder:"Select assessment type",myHelper:A,rules:{required:!0},options:E,myOnChange:e=>{h.Y.info("Add assessments - handleChangeForAssessmentModule hanler");e.target.value;let s=F.filter((s=>s.name===e.target.value));Q("questionnaireId",s[0]._id),Q("assessmentType",e.target.value),G("assessmentType")}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{children:["Member Company ",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(m.Z,{control:U,name:"assignedMember",placeholder:"Select member company",options:k,myHelper:A,myOnChange:async e=>{h.Y.info("Add assessments - HandleChangeForMemberCompany handler"),Q("assignedMember",e.target.value);let s=k.filter((s=>s._id===e.target.value));H.filter((s=>s._id===e.target.value));"The Consumer Goods Forum"===s[0].name?(re(!0),await ve(e.target.value,!0)):(re(!1),await ve(e.target.value,!1),G("assignedOperationMember")),G("assignedMember")},rules:{required:!0}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{children:["Operation Member ",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(m.Z,{control:U,isDisabled:!ne,name:"assignedOperationMember",options:P,placeholder:"Select operation member ",myHelper:A,rules:{required:!0}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{htmlFor:"region",children:["Region",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(m.Z,{control:U,myOnChange:async e=>{h.Y.info("Add member - onRegionChangeHandlerAddMember handler"),Q("country",""),Q("region",e.target.value),G("region");const s=await(async e=>{h.Y.info("Add member - getCountriesAddMember handler");try{return await c.H.get(j.rF+"/".concat(e))}catch(n){var s,a;if("ERR_CANCELED"===(null===n||void 0===n?void 0:n.code))return;return h.Y.info("Add member - getCountriesAddMember handler catch error - ".concat(null===n||void 0===n||null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message," ")),[]}})(W("region")),a=((n=s.data).forEach(((e,s)=>n[s]=e.hasOwnProperty("_id")?e.name:e)),n);var n;oe([...a])},name:"region",rules:{required:!0},placeholder:"Select region",myHelper:A,options:te})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{htmlFor:"country",children:["Country",(0,w.jsx)("span",{className:"mandatory",children:" *"})]}),(0,w.jsx)(m.Z,{control:U,name:"country",rules:{required:!0},myOnChange:async e=>{h.Y.info("Add Member - onCountryChangeHandlerAddMember handler"),Q("country",e.target.value);const s=await c.H.get(j.PO+"/".concat(e.target.value));ce(s.data)},placeholder:"Select country",myHelper:A,options:ie})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsxs)("label",{children:["Due Date ",(0,w.jsx)("span",{className:"mandatory",children:"*"})]}),(0,w.jsx)(l.Qr,{name:"dueDate",control:U,rules:{required:!0},render:e=>{let{field:s,fieldState:{error:a}}=e;return(0,w.jsx)(b._,{dateAdapter:f.y,children:(0,w.jsx)(d.M,{disablePast:!0,className:"datepicker-blk",components:{OpenPickerIcon:v.Z},value:D,onChange:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";O(e),Q("dueDate",null===e||void 0===e?void 0:e.toISOString()),G("dueDate")},renderInput:e=>(0,w.jsx)(n.Z,{autoComplete:"off",...e,className:" input-field ".concat(a&&"input-error"),onKeyDown:fe,placeholder:"MM/DD/YYYY",error:!0,helperText:a?A.dueDate[a.type]:" "})})})}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsx)("label",{children:"Remarks/Comments"}),(0,w.jsx)(l.Qr,{name:"remarks",control:U,rules:{minLength:3,maxLength:250},render:e=>{let{field:s,fieldState:{error:a}}=e;return(0,w.jsx)(n.Z,{multiline:!0,...s,onBlur:e=>{var s;return Q("remarks",null===(s=e.target.value)||void 0===s?void 0:s.trim())},inputProps:{maxLength:250},className:"input-textarea ".concat(a&&"input-textarea-error"),id:"outlined-basic",placeholder:"Enter remarks/comments",helperText:a?A.remarks[a.type]:" ",variant:"outlined"})}})]})}),(0,w.jsx)("div",{className:"card-form-field",children:(0,w.jsxs)("div",{className:"form-group",children:[(0,w.jsx)("label",{children:"Action Plan"}),(0,w.jsxs)("div",{className:"upload-file-wrap",children:[(0,w.jsx)(r.Z,{variant:"contained",component:"label",className:"upload-file-btn",children:(0,w.jsxs)("div",{className:"upload-file-blk",children:[(0,w.jsx)("input",{type:"file",hidden:!0,accept:".doc,  .pdf, .docx, .xlsx, .xls",name:"files[]",onChange:e=>{const s=e.target.files[0];if(s){const a=".".concat(s.name.split(".").pop());if(!se.includes(a.toLowerCase()))return void B({titleMessage:"error!",descriptionMessage:"Invalid file type. Please select a valid file.",messageType:"error"},(()=>I.current()));if(s.size>10485760)return void B({titleMessage:"error!",descriptionMessage:"File size exceeds the limit of 10 MB. Please select a smaller file.",messageType:"error"},(()=>I.current()));Q("actionPlan",e.target.files[0]),console.log("inside if"),ee(s.name);(new FileReader).onload=e=>{var s;X(null===e||void 0===e||null===(s=e.target)||void 0===s?void 0:s.result)}}}}),(0,w.jsx)("span",{className:"upload-icon",children:(0,w.jsx)(x.Z,{})}),(0,w.jsxs)("span",{className:"file-upload-txt",children:["Click here to choose file (max file size"," ","".concat("10"," MB"),") '.doc','.pdf','.xlsx',"]})]})}),(0,w.jsx)("p",{style:{color:"#f7a823",fontFamily:"ProximaNova-Semibold, serif, sans-serif",margin:"10px 0px"},children:"Uploading large files may take some time"}),$,(0,w.jsxs)("span",{className:"file-close-icon",style:{display:$.length>1?"inline-block":"none",cursor:"pointer"},onClick:()=>{X(null),ee(""),ae.delete("actionPlan"),ae.delete("actionPlanName")},children:[" ",(0,w.jsx)(y.Z,{})]})]})]})}),(0,w.jsxs)("div",{className:"form-btn flex-between add-members-btn",children:[(0,w.jsx)("button",{type:"reset",onClick:()=>L("/assessment-list"),className:"secondary-button mr-10",children:"Cancel"}),(0,w.jsx)("button",{type:"submit",className:"primary-button add-button",disabled:me,children:"Save"})]})]})})]})})})]})}},48086:(e,s,a)=>{a.d(s,{Z:()=>l});var n=a(97275),r=(a(72791),a(61134)),t=a(80184);const l=e=>{let{control:s,name:a,myHelper:l,placeholder:i,myOnChange:o,rules:d,onBlur:c,multiline:m,isDisabled:u}=e;const{field:{onChange:p,value:g,ref:h},fieldState:{error:v}}=(0,r.bc)({name:a,control:s,rules:d,defaultValue:""});return(0,t.jsx)(n.Z,{disabled:u,className:"input-field ".concat(v&&"input-error"),placeholder:i,onChange:o||p,onBlur:c,value:g,inputRef:h,inputProps:{maxLength:(null===d||void 0===d?void 0:d.maxLength)&&d.maxLength},helperText:v?l&&l[a]&&l[a][v.type]?l[a][v.type]:"Invalid Input":" ",variant:"outlined"})}},45736:(e,s,a)=>{a.d(s,{K:()=>n});const n=async function(e,s,a,n,r){var t,l;let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if("ERR_CANCELED"===(null===e||void 0===e?void 0:e.code))return null;if(401==(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status))s({titleMessage:"Oops!",descriptionMessage:"Session Timeout: Please login again!",messageType:"error"},(()=>a.current())),setTimeout((()=>{n("/login")}),3e3);else if(403===(null===e||void 0===e||null===(l=e.response)||void 0===l?void 0:l.status)){var o,d,c,m;s({titleMessage:"Oops!",descriptionMessage:null!==e&&void 0!==e&&null!==(o=e.response)&&void 0!==o&&null!==(d=o.data)&&void 0!==d&&d.message?null===e||void 0===e||null===(c=e.response)||void 0===c||null===(m=c.data)||void 0===m?void 0:m.message:"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>a.current())),setTimeout((()=>{n("/home")}),3e3)}else{var u,p,g,h;console.log("error - ",e),s({titleMessage:"Oops!",descriptionMessage:null!==e&&void 0!==e&&null!==(u=e.response)&&void 0!==u&&null!==(p=u.data)&&void 0!==p&&p.message?null===e||void 0===e||null===(g=e.response)||void 0===g||null===(h=g.data)||void 0===h?void 0:h.message:null!==e&&void 0!==e&&e.message?"File not uploaded yet":"Oops! Something went wrong. Please try again later.",messageType:"error"},(()=>a.current())),r&&setTimeout((()=>{n(r,{state:i})}),3e3)}}},1260:(e,s,a)=>{a.d(s,{j:()=>r});var n=a(72791);const r=e=>((0,n.useEffect)((()=>{document.title="HRDD System - ".concat(e)}),[e]),null)},40600:(e,s,a)=>{var n=a(64836);s.Z=void 0;var r=n(a(45649)),t=a(80184),l=(0,r.default)((0,t.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM19 18H6c-2.21 0-4-1.79-4-4 0-2.05 1.53-3.76 3.56-3.97l1.07-.11.5-.95C8.08 7.14 9.94 6 12 6c2.62 0 4.88 1.86 5.39 4.43l.3 1.5 1.53.11c1.56.1 2.78 1.41 2.78 2.96 0 1.65-1.35 3-3 3zM8 13h2.55v3h2.9v-3H16l-4-4z"}),"CloudUploadOutlined");s.Z=l}}]);
//# sourceMappingURL=2172.641280e1.chunk.js.map